module SequentCalculusDraft2b where

open import Prelude
open import Category
open import List
open import ListLemmas
open import AllList
open import FullIPLPropositions
open import FullIPLDerivations hiding (cut)
open import SequentCalculusDrafta


--------------------------------------------------------------------------------


-- -- Sequent calculus

-- infix 3 _โน_
-- data _โน_ : List Prop โ Prop โ Set
--   where
--     โR : โ {A B ฮ} โ ฮ , A โน B
--                    โ ฮ โน A โ B

--     โงR : โ {A B ฮ} โ ฮ โน A โ ฮ โน B
--                    โ ฮ โน A โง B

--     ๐R : โ {ฮ} โ ฮ โน ๐

--     โจRโ : โ {A B ฮ} โ ฮ โน A
--                     โ ฮ โน A โจ B

--     โจRโ : โ {A B ฮ} โ ฮ โน B
--                     โ ฮ โน A โจ B

--     vzโ : โ {A ฮ} โ ฮ , A โน A

--     wkโ : โ {A B ฮ} โ ฮ โน B
--                     โ ฮ , A โน B

--     exโ : โ {ฮ A B C} โ ฮ , A , B โน C
--                       โ ฮ , B , A โน C

--     ctโ : โ {ฮ A B} โ ฮ , A , A โน B
--                     โ ฮ , A โน B

--     โL : โ {A B C ฮ} โ ฮ , A โ B โน A โ ฮ , A โ B , B โน C
--                      โ ฮ , A โ B โน C

--     โงLโ : โ {A B C ฮ} โ ฮ , A โง B , A โน C
--                       โ ฮ , A โง B โน C

--     โงLโ : โ {A B C ฮ} โ ฮ , A โง B , B โน C
--                       โ ฮ , A โง B โน C

--     ๐L : โ {A ฮ} โ ฮ , ๐ โน A

--     โจL : โ {A B C ฮ} โ ฮ , A โจ B , A โน C โ ฮ , A โจ B , B โน C
--                      โ ฮ , A โจ B โน C

-- infix 3 _โน_all
-- _โน_all : List Prop โ List Prop โ Set
-- ฮ โน ฮ all = All (ฮ โน_) ฮ


-- -- Theorem 3.6 (Soundness of sequent calculus with respect to normal deduction)

-- thm36 : โ {ฮ A} โ ฮ โน A
--                 โ ฮ โข A normal
-- thm36 (โR ๐)   = lam (thm36 ๐)
-- thm36 (โงR ๐ โฐ) = pair (thm36 ๐) (thm36 โฐ)
-- thm36 ๐R       = unit
-- thm36 (โจRโ ๐)  = inl (thm36 ๐)
-- thm36 (โจRโ ๐)  = inr (thm36 ๐)
-- thm36 vzโ      = vzโโ
-- thm36 (wkโ ๐)  = wkโโ (thm36 ๐)
-- thm36 (exโ ๐)  = exโโ (thm36 ๐)
-- thm36 (ctโ ๐)  = ctโโ (thm36 ๐)
-- thm36 (โL ๐ โฐ) = cutโโ (app vzโโ (thm36 ๐)) (thm36 โฐ)
-- thm36 (โงLโ ๐)  = cutโโ (fst vzโโ) (thm36 ๐)
-- thm36 (โงLโ ๐)  = cutโโ (snd vzโโ) (thm36 ๐)
-- thm36 ๐L       = abort vzโโ
-- thm36 (โจL ๐ โฐ) = case vzโโ (thm36 ๐) (thm36 โฐ)


-- -- Corollary ??? (Soundness of sequent calculus with respect to natural deduction)

-- cor36โฒ : โ {ฮ A} โ ฮ โน A
--                  โ ฮ โข A true
-- cor36โฒ ๐ = thm31โโ (thm36 ๐)


-- -- Lemma 3.7 (Structural properties of sequent calculus)

-- varโ : โ {A ฮ} โ ฮ โ A
--                โ ฮ โน A
-- varโ zero    = vzโ
-- varโ (suc i) = wkโ (varโ i)

-- wksโ : โ {A ฮ ฮ} โ ฮ โน ฮ all
--                  โ ฮ , A โน ฮ all
-- wksโ ฮพ = maps wkโ ฮพ

-- liftsโ : โ {A ฮ ฮ} โ ฮ โน ฮ all
--                    โ ฮ , A โน ฮ , A all
-- liftsโ ฮพ = wksโ ฮพ , vzโ

-- idsโ : โ {ฮ} โ ฮ โน ฮ all
-- idsโ {โ}     = โ
-- idsโ {ฮ , A} = liftsโ idsโ

-- subโ : โ {ฮ ฮ A} โ ฮ โน ฮ all โ ฮ โน A
--                  โ ฮ โน A
-- subโ ฮพ           (โR ๐)   = โR (subโ (liftsโ ฮพ) ๐)
-- subโ ฮพ           (โงR ๐ โฐ) = โงR (subโ ฮพ ๐) (subโ ฮพ โฐ)
-- subโ ฮพ           ๐R       = ๐R
-- subโ ฮพ           (โจRโ ๐)  = โจRโ (subโ ฮพ ๐)
-- subโ ฮพ           (โจRโ ๐)  = โจRโ (subโ ฮพ ๐)
-- subโ (ฮพ , ๐)     vzโ      = ๐
-- subโ (ฮพ , ๐)     (wkโ ๐)  = subโ ฮพ ๐
-- subโ (ฮพ , โฌ , ๐) (exโ ๐)  = subโ (ฮพ , ๐ , โฌ) ๐
-- subโ (ฮพ , ๐)     (ctโ ๐)  = subโ (ฮพ , ๐ , ๐) ๐
-- subโ (ฮพ , ๐)     (โL ๐ โฐ) = {!!}
-- subโ (ฮพ , ๐)     (โงLโ ๐)  = {!!}
-- subโ (ฮพ , ๐)     (โงLโ ๐)  = {!!}
-- subโ (ฮพ , ๐)     ๐L       = {!!}
-- subโ (ฮพ , ๐)     (โจL ๐ โฐ) = {!!}

-- renโ : โ {ฮ ฮโฒ A} โ ฮโฒ โ ฮ โ ฮ โน A
--                   โ ฮโฒ โน A
-- renโ ฮท (โR ๐)   = โR (renโ (keepโ ฮท) ๐)
-- renโ ฮท (โงR ๐ โฐ) = โงR (renโ ฮท ๐) (renโ ฮท โฐ)
-- renโ ฮท ๐R       = ๐R
-- renโ ฮท (โจRโ ๐)  = โจRโ (renโ ฮท ๐)
-- renโ ฮท (โจRโ ๐)  = โจRโ (renโ ฮท ๐)
-- renโ ฮท vzโ      = varโ (ฮท zero)
-- renโ ฮท (wkโ ๐)  = renโ (ฮท โ suc) ๐
-- renโ ฮท (exโ ๐)  = renโ (ฮท โ exโ) ๐
-- renโ ฮท (ctโ ๐)  = renโ (ฮท โ ctโ) ๐
-- renโ ฮท (โL ๐ โฐ) = {!!}
-- renโ ฮท (โงLโ ๐)  = {!!}
-- renโ ฮท (โงLโ ๐)  = {!!}
-- renโ ฮท ๐L       = {!!}
-- renโ ฮท (โจL ๐ โฐ) = {!!}


-- -- Theorem 3.8 (Completeness of sequent calculus with respect to normal/neutral deductions)

-- mutual
--   thm38โโ : โ {ฮ A} โ ฮ โข A normal
--                     โ ฮ โน A
--   thm38โโ (lam ๐)      = โR (thm38โโ ๐)
--   thm38โโ (pair ๐ โฐ)   = โงR (thm38โโ ๐) (thm38โโ โฐ)
--   thm38โโ unit         = ๐R
--   thm38โโ (abort ๐)    = thm38โโ ๐ ๐L
--   thm38โโ (inl ๐)      = โจRโ (thm38โโ ๐)
--   thm38โโ (inr ๐)      = โจRโ (thm38โโ ๐)
--   thm38โโ (case ๐ โฐ โฑ) = thm38โโ ๐ (โจL (exโ (wkโ (thm38โโ โฐ))) (exโ (wkโ (thm38โโ โฑ))))
--   thm38โโ (ent ๐)      = thm38โโ ๐ vzโ

--   thm38โโ : โ {ฮ A B} โ ฮ โข A neutral โ ฮ , A โน B
--                       โ ฮ โน B
--   thm38โโ (var i)     โฐ = renโ (genctโ i) โฐ
--   thm38โโ (app ๐โ ๐โ) โฐ = thm38โโ ๐โ (โL (wkโ (thm38โโ ๐โ)) (exโ (wkโ โฐ)))
--   thm38โโ (fst ๐)     โฐ = thm38โโ ๐ (โงLโ (exโ (wkโ โฐ)))
--   thm38โโ (snd ๐)     โฐ = thm38โโ ๐ (โงLโ (exโ (wkโ โฐ)))


--------------------------------------------------------------------------------


-- Sequent calculus with cut

infix 3 _โนโ_
data _โนโ_ : List Prop โ Prop โ Set
  where
    โR : โ {A B ฮ} โ ฮ , A โนโ B
                   โ ฮ โนโ A โ B

    โงR : โ {A B ฮ} โ ฮ โนโ A โ ฮ โนโ B
                   โ ฮ โนโ A โง B

    ๐R : โ {ฮ} โ ฮ โนโ ๐

    โจRโ : โ {A B ฮ} โ ฮ โนโ A
                    โ ฮ โนโ A โจ B

    โจRโ : โ {A B ฮ} โ ฮ โนโ B
                    โ ฮ โนโ A โจ B

    vzโโ : โ {A ฮ} โ ฮ , A โนโ A

    wkโโ : โ {A B ฮ} โ ฮ โนโ B
                     โ ฮ , A โนโ B

    exโโ : โ {ฮ A B C} โ ฮ , A , B โนโ C
                       โ ฮ , B , A โนโ C

    ctโโ : โ {ฮ A B} โ ฮ , A , A โนโ B
                     โ ฮ , A โนโ B

    โL : โ {A B C ฮ} โ ฮ , A โ B โนโ A โ ฮ , A โ B , B โนโ C
                     โ ฮ , A โ B โนโ C

    โงLโ : โ {A B C ฮ} โ ฮ , A โง B , A โนโ C
                      โ ฮ , A โง B โนโ C

    โงLโ : โ {A B C ฮ} โ ฮ , A โง B , B โนโ C
                      โ ฮ , A โง B โนโ C

    ๐L : โ {A ฮ} โ ฮ , ๐ โนโ A

    โจL : โ {A B C ฮ} โ ฮ , A โจ B , A โนโ C โ ฮ , A โจ B , B โนโ C
                     โ ฮ , A โจ B โนโ C

    cut : โ {A B ฮ} โ ฮ โนโ A โ ฮ , A โนโ B
                    โ ฮ โนโ B

infix 3 _โนโ_all
_โนโ_all : List Prop โ List Prop โ Set
ฮ โนโ ฮ all = All (ฮ โนโ_) ฮ


-- Theorem 3.9 (Soundness of sequent calculus with cut with respect to annotated normal deduction)

thm39 : โ {ฮ A} โ ฮ โนโ A
                โ ฮ โขโ A normal
thm39 (โR ๐)    = lam (thm39 ๐)
thm39 (โงR ๐ โฐ)  = pair (thm39 ๐) (thm39 โฐ)
thm39 ๐R        = unit
thm39 (โจRโ ๐)   = inl (thm39 ๐)
thm39 (โจRโ ๐)   = inr (thm39 ๐)
thm39 vzโโ      = vzโโโ
thm39 (wkโโ ๐)  = wkโโโ (thm39 ๐)
thm39 (exโโ ๐)  = exโโโ (thm39 ๐)
thm39 (ctโโ ๐)  = ctโโโ (thm39 ๐)
thm39 (โL ๐ โฐ)  = cutโโโ (app vzโโโ (thm39 ๐)) (thm39 โฐ)
thm39 (โงLโ ๐)   = cutโโโ (fst vzโโโ) (thm39 ๐)
thm39 (โงLโ ๐)   = cutโโโ (snd vzโโโ) (thm39 ๐)
thm39 ๐L        = abort vzโโโ
thm39 (โจL ๐ โฐ)  = case vzโโโ (thm39 ๐) (thm39 โฐ)
thm39 (cut ๐ โฐ) = cutโโโ (enm (thm39 ๐)) (thm39 โฐ)


-- Lemma ??? (Structural properties of sequent calculus with cut)

varโโ : โ {A ฮ} โ ฮ โ A
                โ ฮ โนโ A
varโโ zero    = vzโโ
varโโ (suc i) = wkโโ (varโโ i)

wksโโ : โ {A ฮ ฮ} โ ฮ โนโ ฮ all
                  โ ฮ , A โนโ ฮ all
wksโโ ฮพ = maps wkโโ ฮพ

liftsโโ : โ {A ฮ ฮ} โ ฮ โนโ ฮ all
                    โ ฮ , A โนโ ฮ , A all
liftsโโ ฮพ = wksโโ ฮพ , vzโโ

idsโโ : โ {ฮ} โ ฮ โนโ ฮ all
idsโโ {โ}     = โ
idsโโ {ฮ , A} = liftsโโ idsโโ

renโโ : โ {ฮ ฮโฒ A} โ ฮโฒ โ ฮ โ ฮ โนโ A
                   โ ฮโฒ โนโ A
renโโ ฮท (โR ๐)    = โR (renโโ (keepโ ฮท) ๐)
renโโ ฮท (โงR ๐ โฐ)  = โงR (renโโ ฮท ๐) (renโโ ฮท โฐ)
renโโ ฮท ๐R        = ๐R
renโโ ฮท (โจRโ ๐)   = โจRโ (renโโ ฮท ๐)
renโโ ฮท (โจRโ ๐)   = โจRโ (renโโ ฮท ๐)
renโโ ฮท vzโโ      = varโโ (ฮท zero)
renโโ ฮท (wkโโ ๐)  = renโโ (ฮท โ suc) ๐
renโโ ฮท (exโโ ๐)  = renโโ (ฮท โ exโ) ๐
renโโ ฮท (ctโโ ๐)  = renโโ (ฮท โ ctโ) ๐
renโโ ฮท (โL ๐ โฐ)  = cut (varโโ (ฮท zero)) (โL (renโโ (dropโ ฮท) ๐) (renโโ (keepโ (dropโ ฮท)) โฐ))
renโโ ฮท (โงLโ ๐)   = cut (varโโ (ฮท zero)) (โงLโ (renโโ (keepโ (dropโ ฮท)) ๐))
renโโ ฮท (โงLโ ๐)   = cut (varโโ (ฮท zero)) (โงLโ (renโโ (keepโ (dropโ ฮท)) ๐))
renโโ ฮท ๐L        = cut (varโโ (ฮท zero)) ๐L
renโโ ฮท (โจL ๐ โฐ)  = cut (varโโ (ฮท zero)) (โจL (renโโ (keepโ (dropโ ฮท)) ๐) (renโโ (keepโ (dropโ ฮท)) โฐ))
renโโ ฮท (cut ๐ โฐ) = cut (renโโ ฮท ๐) (renโโ (keepโ ฮท) โฐ)

subโโ : โ {ฮ ฮ A} โ ฮ โนโ ฮ all โ ฮ โนโ A
                  โ ฮ โนโ A
subโโ ฮพ           (โR ๐)    = โR (subโโ (liftsโโ ฮพ) ๐)
subโโ ฮพ           (โงR ๐ โฐ)  = โงR (subโโ ฮพ ๐) (subโโ ฮพ โฐ)
subโโ ฮพ           ๐R        = ๐R
subโโ ฮพ           (โจRโ ๐)   = โจRโ (subโโ ฮพ ๐)
subโโ ฮพ           (โจRโ ๐)   = โจRโ (subโโ ฮพ ๐)
subโโ (ฮพ , ๐)     vzโโ      = ๐
subโโ (ฮพ , ๐)     (wkโโ ๐)  = subโโ ฮพ ๐
subโโ (ฮพ , โฌ , ๐) (exโโ ๐)  = subโโ (ฮพ , ๐ , โฌ) ๐
subโโ (ฮพ , ๐)     (ctโโ ๐)  = subโโ (ฮพ , ๐ , ๐) ๐
subโโ (ฮพ , ๐)     (โL ๐ โฐ)  = cut ๐ (โL (subโโ (liftsโโ ฮพ) ๐) (subโโ (liftsโโ (liftsโโ ฮพ)) โฐ))
subโโ (ฮพ , ๐)     (โงLโ ๐)   = cut ๐ (โงLโ (subโโ (liftsโโ (liftsโโ ฮพ)) ๐))
subโโ (ฮพ , ๐)     (โงLโ ๐)   = cut ๐ (โงLโ (subโโ (liftsโโ (liftsโโ ฮพ)) ๐))
subโโ (ฮพ , ๐)     ๐L        = cut ๐ ๐L
subโโ (ฮพ , ๐)     (โจL ๐ โฐ)  = cut ๐ (โจL (subโโ (liftsโโ (liftsโโ ฮพ)) ๐) (subโโ (liftsโโ (liftsโโ ฮพ)) โฐ))
subโโ ฮพ           (cut ๐ โฐ) = cut (subโโ ฮพ ๐) (subโโ (liftsโโ ฮพ) โฐ)


-- Theorem 3.10 (Completeness of sequent calculus with cut with respect to normal/neutral deductions)

mutual
  thm310โโ : โ {ฮ A} โ ฮ โข A normal
                    โ ฮ โนโ A
  thm310โโ (lam ๐)      = โR (thm310โโ ๐)
  thm310โโ (pair ๐ โฐ)   = โงR (thm310โโ ๐) (thm310โโ โฐ)
  thm310โโ unit         = ๐R
  thm310โโ (abort ๐)    = thm310โโ ๐ ๐L
  thm310โโ (inl ๐)      = โจRโ (thm310โโ ๐)
  thm310โโ (inr ๐)      = โจRโ (thm310โโ ๐)
  thm310โโ (case ๐ โฐ โฑ) = thm310โโ ๐ (โจL (exโโ (wkโโ (thm310โโ โฐ))) (exโโ (wkโโ (thm310โโ โฑ))))
  thm310โโ (ent ๐)      = thm310โโ ๐ vzโโ

  thm310โโ : โ {ฮ A B} โ ฮ โข A neutral โ ฮ , A โนโ B
                      โ ฮ โนโ B
  thm310โโ (var i)     โฐ = renโโ (genctโ i) โฐ
  thm310โโ (app ๐โ ๐โ) โฐ = thm310โโ ๐โ (โL (wkโโ (thm310โโ ๐โ)) (exโโ (wkโโ โฐ)))
  thm310โโ (fst ๐)     โฐ = thm310โโ ๐ (โงLโ (exโโ (wkโโ โฐ)))
  thm310โโ (snd ๐)     โฐ = thm310โโ ๐ (โงLโ (exโโ (wkโโ โฐ)))


--------------------------------------------------------------------------------
