<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201706.IMCLP</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="A201706.IMCLP.html" class="Module">A201706.IMCLP</a> <a id="22" class="Keyword">where</a>

<a id="29" class="Keyword">open</a> <a id="34" class="Keyword">import</a> <a id="41" href="A201706.PreludeVec.html" class="Module">A201706.PreludeVec</a> <a id="60" class="Keyword">public</a>


<a id="69" class="Comment">-- Terms.</a>

<a id="80" class="Keyword">mutual</a>
  <a id="89" class="Keyword">data</a> <a id="Tm"></a><a id="94" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="97" class="Symbol">(</a><a id="98" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="100" href="A201706.IMCLP.html#100" class="Bound">g</a> <a id="102" class="Symbol">:</a> <a id="104" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a><a id="107" class="Symbol">)</a> <a id="109" class="Symbol">:</a> <a id="111" class="PrimitiveType">Set</a> <a id="115" class="Keyword">where</a>
    <a id="Tm.VAR"></a><a id="125" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a>   <a id="131" class="Symbol">:</a> <a id="133" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="137" href="A201706.IMCLP.html#100" class="Bound">g</a> <a id="139" class="Symbol">→</a> <a id="141" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="144" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="146" href="A201706.IMCLP.html#100" class="Bound">g</a>
    <a id="Tm.MVAR"></a><a id="152" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a>  <a id="158" class="Symbol">:</a> <a id="160" class="Symbol">∀</a> <a id="162" class="Symbol">{</a><a id="163" href="A201706.IMCLP.html#163" class="Bound">`d</a><a id="165" class="Symbol">}</a> <a id="167" class="Symbol">→</a> <a id="169" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="173" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="175" href="Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a> <a id="180" href="A201706.IMCLP.html#163" class="Bound">`d</a> <a id="183" class="Symbol">→</a> <a id="185" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="189" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="191" class="Symbol">→</a> <a id="193" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="196" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="198" href="A201706.IMCLP.html#100" class="Bound">g</a>
    <a id="Tm.LAM"></a><a id="204" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a>   <a id="210" class="Symbol">:</a> <a id="212" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="215" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="217" class="Symbol">(</a><a id="218" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="222" href="A201706.IMCLP.html#100" class="Bound">g</a><a id="223" class="Symbol">)</a> <a id="225" class="Symbol">→</a> <a id="227" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="230" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="232" href="A201706.IMCLP.html#100" class="Bound">g</a>
    <a id="Tm.APP"></a><a id="238" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a>   <a id="244" class="Symbol">:</a> <a id="246" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="249" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="251" href="A201706.IMCLP.html#100" class="Bound">g</a> <a id="253" class="Symbol">→</a> <a id="255" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="258" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="260" href="A201706.IMCLP.html#100" class="Bound">g</a> <a id="262" class="Symbol">→</a> <a id="264" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="267" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="269" href="A201706.IMCLP.html#100" class="Bound">g</a>
    <a id="Tm.BOX"></a><a id="275" href="A201706.IMCLP.html#275" class="InductiveConstructor">BOX</a>   <a id="281" class="Symbol">:</a> <a id="283" class="Symbol">∀</a> <a id="285" class="Symbol">{</a><a id="286" href="A201706.IMCLP.html#286" class="Bound">`d</a><a id="288" class="Symbol">}</a> <a id="290" class="Symbol">→</a> <a id="292" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="295" href="A201706.IMCLP.html#286" class="Bound">`d</a> <a id="298" href="Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a> <a id="303" class="Symbol">→</a> <a id="305" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="308" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="310" href="A201706.IMCLP.html#100" class="Bound">g</a>
    <a id="Tm.UNBOX"></a><a id="316" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="322" class="Symbol">:</a> <a id="324" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="327" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="329" href="A201706.IMCLP.html#100" class="Bound">g</a> <a id="331" class="Symbol">→</a> <a id="333" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="336" class="Symbol">(</a><a id="337" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="341" href="A201706.IMCLP.html#98" class="Bound">d</a><a id="342" class="Symbol">)</a> <a id="344" href="A201706.IMCLP.html#100" class="Bound">g</a> <a id="346" class="Symbol">→</a> <a id="348" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="351" href="A201706.IMCLP.html#98" class="Bound">d</a> <a id="353" href="A201706.IMCLP.html#100" class="Bound">g</a>

  <a id="Tm⋆"></a><a id="358" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="362" class="Symbol">:</a> <a id="364" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a> <a id="368" class="Symbol">→</a> <a id="370" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a> <a id="374" class="Symbol">→</a> <a id="376" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a> <a id="380" class="Symbol">→</a> <a id="382" class="PrimitiveType">Set</a>
  <a id="388" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="392" href="A201706.IMCLP.html#392" class="Bound">d</a> <a id="394" href="A201706.IMCLP.html#394" class="Bound">g</a> <a id="396" href="A201706.IMCLP.html#396" class="Bound">n</a> <a id="398" class="Symbol">=</a> <a id="400" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="404" class="Symbol">(</a><a id="405" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="408" href="A201706.IMCLP.html#392" class="Bound">d</a> <a id="410" href="A201706.IMCLP.html#394" class="Bound">g</a><a id="411" class="Symbol">)</a> <a id="413" href="A201706.IMCLP.html#396" class="Bound">n</a>

<a id="416" class="Keyword">mutual</a>
  <a id="monoTm"></a><a id="425" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="432" class="Symbol">:</a> <a id="434" class="Symbol">∀</a> <a id="436" class="Symbol">{</a><a id="437" href="A201706.IMCLP.html#437" class="Bound">d</a> <a id="439" href="A201706.IMCLP.html#439" class="Bound">g</a> <a id="441" href="A201706.IMCLP.html#441" class="Bound">d′</a> <a id="444" href="A201706.IMCLP.html#444" class="Bound">g′</a><a id="446" class="Symbol">}</a> <a id="448" class="Symbol">→</a> <a id="450" href="A201706.IMCLP.html#441" class="Bound">d′</a> <a id="453" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="455" href="A201706.IMCLP.html#437" class="Bound">d</a> <a id="457" class="Symbol">→</a> <a id="459" href="A201706.IMCLP.html#444" class="Bound">g′</a> <a id="462" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="464" href="A201706.IMCLP.html#439" class="Bound">g</a> <a id="466" class="Symbol">→</a> <a id="468" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="471" href="A201706.IMCLP.html#437" class="Bound">d</a> <a id="473" href="A201706.IMCLP.html#439" class="Bound">g</a> <a id="475" class="Symbol">→</a> <a id="477" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="480" href="A201706.IMCLP.html#441" class="Bound">d′</a> <a id="483" href="A201706.IMCLP.html#444" class="Bound">g′</a>
  <a id="488" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="495" href="A201706.IMCLP.html#495" class="Bound">z</a> <a id="497" href="A201706.IMCLP.html#497" class="Bound">e</a> <a id="499" class="Symbol">(</a><a id="500" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="504" href="A201706.IMCLP.html#504" class="Bound">i</a><a id="505" class="Symbol">)</a>     <a id="511" class="Symbol">=</a> <a id="513" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="517" class="Symbol">(</a><a id="518" href="A201706.Prelude.html#9177" class="Function">monoFin</a> <a id="526" href="A201706.IMCLP.html#497" class="Bound">e</a> <a id="528" href="A201706.IMCLP.html#504" class="Bound">i</a><a id="529" class="Symbol">)</a>
  <a id="533" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="540" href="A201706.IMCLP.html#540" class="Bound">z</a> <a id="542" href="A201706.IMCLP.html#542" class="Bound">e</a> <a id="544" class="Symbol">(</a><a id="545" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a> <a id="550" href="A201706.IMCLP.html#550" class="Bound">q</a> <a id="552" href="A201706.IMCLP.html#552" class="Bound">i</a><a id="553" class="Symbol">)</a>  <a id="556" class="Symbol">=</a> <a id="558" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a> <a id="563" class="Symbol">(</a><a id="564" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="572" href="A201706.IMCLP.html#540" class="Bound">z</a> <a id="574" href="A201706.Prelude.html#6658" class="InductiveConstructor">done</a> <a id="579" href="A201706.IMCLP.html#550" class="Bound">q</a><a id="580" class="Symbol">)</a> <a id="582" class="Symbol">(</a><a id="583" href="A201706.Prelude.html#9177" class="Function">monoFin</a> <a id="591" href="A201706.IMCLP.html#540" class="Bound">z</a> <a id="593" href="A201706.IMCLP.html#552" class="Bound">i</a><a id="594" class="Symbol">)</a>
  <a id="598" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="605" href="A201706.IMCLP.html#605" class="Bound">z</a> <a id="607" href="A201706.IMCLP.html#607" class="Bound">e</a> <a id="609" class="Symbol">(</a><a id="610" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a> <a id="614" href="A201706.IMCLP.html#614" class="Bound">M</a><a id="615" class="Symbol">)</a>     <a id="621" class="Symbol">=</a> <a id="623" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a> <a id="627" class="Symbol">(</a><a id="628" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="635" href="A201706.IMCLP.html#605" class="Bound">z</a> <a id="637" class="Symbol">(</a><a id="638" href="A201706.Prelude.html#6719" class="InductiveConstructor">lift</a> <a id="643" href="A201706.IMCLP.html#607" class="Bound">e</a><a id="644" class="Symbol">)</a> <a id="646" href="A201706.IMCLP.html#614" class="Bound">M</a><a id="647" class="Symbol">)</a>
  <a id="651" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="658" href="A201706.IMCLP.html#658" class="Bound">z</a> <a id="660" href="A201706.IMCLP.html#660" class="Bound">e</a> <a id="662" class="Symbol">(</a><a id="663" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a> <a id="667" href="A201706.IMCLP.html#667" class="Bound">M</a> <a id="669" href="A201706.IMCLP.html#669" class="Bound">N</a><a id="670" class="Symbol">)</a>   <a id="674" class="Symbol">=</a> <a id="676" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a> <a id="680" class="Symbol">(</a><a id="681" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="688" href="A201706.IMCLP.html#658" class="Bound">z</a> <a id="690" href="A201706.IMCLP.html#660" class="Bound">e</a> <a id="692" href="A201706.IMCLP.html#667" class="Bound">M</a><a id="693" class="Symbol">)</a> <a id="695" class="Symbol">(</a><a id="696" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="703" href="A201706.IMCLP.html#658" class="Bound">z</a> <a id="705" href="A201706.IMCLP.html#660" class="Bound">e</a> <a id="707" href="A201706.IMCLP.html#669" class="Bound">N</a><a id="708" class="Symbol">)</a>
  <a id="712" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="719" href="A201706.IMCLP.html#719" class="Bound">z</a> <a id="721" href="A201706.IMCLP.html#721" class="Bound">e</a> <a id="723" class="Symbol">(</a><a id="724" href="A201706.IMCLP.html#275" class="InductiveConstructor">BOX</a> <a id="728" href="A201706.IMCLP.html#728" class="Bound">M</a><a id="729" class="Symbol">)</a>     <a id="735" class="Symbol">=</a> <a id="737" href="A201706.IMCLP.html#275" class="InductiveConstructor">BOX</a> <a id="741" href="A201706.IMCLP.html#728" class="Bound">M</a>
  <a id="745" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="752" href="A201706.IMCLP.html#752" class="Bound">z</a> <a id="754" href="A201706.IMCLP.html#754" class="Bound">e</a> <a id="756" class="Symbol">(</a><a id="757" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="763" href="A201706.IMCLP.html#763" class="Bound">M</a> <a id="765" href="A201706.IMCLP.html#765" class="Bound">N</a><a id="766" class="Symbol">)</a> <a id="768" class="Symbol">=</a> <a id="770" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="776" class="Symbol">(</a><a id="777" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="784" href="A201706.IMCLP.html#752" class="Bound">z</a> <a id="786" href="A201706.IMCLP.html#754" class="Bound">e</a> <a id="788" href="A201706.IMCLP.html#763" class="Bound">M</a><a id="789" class="Symbol">)</a> <a id="791" class="Symbol">(</a><a id="792" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="799" class="Symbol">(</a><a id="800" href="A201706.Prelude.html#6719" class="InductiveConstructor">lift</a> <a id="805" href="A201706.IMCLP.html#752" class="Bound">z</a><a id="806" class="Symbol">)</a> <a id="808" href="A201706.IMCLP.html#754" class="Bound">e</a> <a id="810" href="A201706.IMCLP.html#765" class="Bound">N</a><a id="811" class="Symbol">)</a>

  <a id="monoTm⋆"></a><a id="816" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="824" class="Symbol">:</a> <a id="826" class="Symbol">∀</a> <a id="828" class="Symbol">{</a><a id="829" href="A201706.IMCLP.html#829" class="Bound">d</a> <a id="831" href="A201706.IMCLP.html#831" class="Bound">g</a> <a id="833" href="A201706.IMCLP.html#833" class="Bound">d′</a> <a id="836" href="A201706.IMCLP.html#836" class="Bound">g′</a> <a id="839" href="A201706.IMCLP.html#839" class="Bound">n</a><a id="840" class="Symbol">}</a> <a id="842" class="Symbol">→</a> <a id="844" href="A201706.IMCLP.html#833" class="Bound">d′</a> <a id="847" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="849" href="A201706.IMCLP.html#829" class="Bound">d</a> <a id="851" class="Symbol">→</a> <a id="853" href="A201706.IMCLP.html#836" class="Bound">g′</a> <a id="856" href="A201706.Prelude.html#6628" class="Datatype Operator">≥</a> <a id="858" href="A201706.IMCLP.html#831" class="Bound">g</a> <a id="860" class="Symbol">→</a> <a id="862" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="866" href="A201706.IMCLP.html#829" class="Bound">d</a> <a id="868" href="A201706.IMCLP.html#831" class="Bound">g</a> <a id="870" href="A201706.IMCLP.html#839" class="Bound">n</a> <a id="872" class="Symbol">→</a> <a id="874" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="878" href="A201706.IMCLP.html#833" class="Bound">d′</a> <a id="881" href="A201706.IMCLP.html#836" class="Bound">g′</a> <a id="884" href="A201706.IMCLP.html#839" class="Bound">n</a>
  <a id="888" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="896" href="A201706.IMCLP.html#896" class="Bound">z</a> <a id="898" href="A201706.IMCLP.html#898" class="Bound">e</a> <a id="900" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="908" class="Symbol">=</a> <a id="910" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
  <a id="914" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="922" href="A201706.IMCLP.html#922" class="Bound">z</a> <a id="924" href="A201706.IMCLP.html#924" class="Bound">e</a> <a id="926" class="Symbol">(</a><a id="927" href="A201706.IMCLP.html#927" class="Bound">x</a> <a id="929" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="931" href="A201706.IMCLP.html#931" class="Bound">M</a><a id="932" class="Symbol">)</a> <a id="934" class="Symbol">=</a> <a id="936" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="944" href="A201706.IMCLP.html#922" class="Bound">z</a> <a id="946" href="A201706.IMCLP.html#924" class="Bound">e</a> <a id="948" href="A201706.IMCLP.html#927" class="Bound">x</a> <a id="950" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="952" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="959" href="A201706.IMCLP.html#922" class="Bound">z</a> <a id="961" href="A201706.IMCLP.html#924" class="Bound">e</a> <a id="963" href="A201706.IMCLP.html#931" class="Bound">M</a>
  <a id="967" class="Comment">-- NOTE: Equivalent, but does not pass termination check.</a>
  <a id="1027" class="Comment">-- monoTm⋆ z e x = map (monoTm z e) x</a>

<a id="1066" class="Keyword">mutual</a>
  <a id="idmonoTm"></a><a id="1075" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1084" class="Symbol">:</a> <a id="1086" class="Symbol">∀</a> <a id="1088" class="Symbol">{</a><a id="1089" href="A201706.IMCLP.html#1089" class="Bound">d</a> <a id="1091" href="A201706.IMCLP.html#1091" class="Bound">g</a><a id="1092" class="Symbol">}</a> <a id="1094" class="Symbol">→</a> <a id="1096" class="Symbol">(</a><a id="1097" href="A201706.IMCLP.html#1097" class="Bound">M</a> <a id="1099" class="Symbol">:</a> <a id="1101" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="1104" href="A201706.IMCLP.html#1089" class="Bound">d</a> <a id="1106" href="A201706.IMCLP.html#1091" class="Bound">g</a><a id="1107" class="Symbol">)</a> <a id="1109" class="Symbol">→</a> <a id="1111" href="A201706.IMCLP.html#425" class="Function">monoTm</a> <a id="1118" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1124" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1130" href="A201706.IMCLP.html#1097" class="Bound">M</a> <a id="1132" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1134" href="A201706.IMCLP.html#1097" class="Bound">M</a>
  <a id="1138" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1147" class="Symbol">(</a><a id="1148" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="1152" href="A201706.IMCLP.html#1152" class="Bound">i</a><a id="1153" class="Symbol">)</a>     <a id="1159" class="Symbol">=</a> <a id="1161" href="A201706.Prelude.html#1240" class="Function">cong</a> <a id="1166" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="1170" class="Symbol">(</a><a id="1171" href="A201706.Prelude.html#9785" class="Function">idmonoFin</a> <a id="1181" href="A201706.IMCLP.html#1152" class="Bound">i</a><a id="1182" class="Symbol">)</a>
  <a id="1186" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1195" class="Symbol">(</a><a id="1196" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a> <a id="1201" href="A201706.IMCLP.html#1201" class="Bound">q</a> <a id="1203" href="A201706.IMCLP.html#1203" class="Bound">i</a><a id="1204" class="Symbol">)</a>  <a id="1207" class="Symbol">=</a> <a id="1209" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1215" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a> <a id="1220" class="Symbol">(</a><a id="1221" href="A201706.IMCLP.html#1452" class="Function">idmonoTm⋆</a> <a id="1231" href="A201706.IMCLP.html#1201" class="Bound">q</a><a id="1232" class="Symbol">)</a> <a id="1234" class="Symbol">(</a><a id="1235" href="A201706.Prelude.html#9785" class="Function">idmonoFin</a> <a id="1245" href="A201706.IMCLP.html#1203" class="Bound">i</a><a id="1246" class="Symbol">)</a>
  <a id="1250" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1259" class="Symbol">(</a><a id="1260" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a> <a id="1264" href="A201706.IMCLP.html#1264" class="Bound">M</a><a id="1265" class="Symbol">)</a>     <a id="1271" class="Symbol">=</a> <a id="1273" href="A201706.Prelude.html#1240" class="Function">cong</a> <a id="1278" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a> <a id="1282" class="Symbol">(</a><a id="1283" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1292" href="A201706.IMCLP.html#1264" class="Bound">M</a><a id="1293" class="Symbol">)</a>
  <a id="1297" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1306" class="Symbol">(</a><a id="1307" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a> <a id="1311" href="A201706.IMCLP.html#1311" class="Bound">M</a> <a id="1313" href="A201706.IMCLP.html#1313" class="Bound">N</a><a id="1314" class="Symbol">)</a>   <a id="1318" class="Symbol">=</a> <a id="1320" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1326" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a> <a id="1330" class="Symbol">(</a><a id="1331" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1340" href="A201706.IMCLP.html#1311" class="Bound">M</a><a id="1341" class="Symbol">)</a> <a id="1343" class="Symbol">(</a><a id="1344" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1353" href="A201706.IMCLP.html#1313" class="Bound">N</a><a id="1354" class="Symbol">)</a>
  <a id="1358" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1367" class="Symbol">(</a><a id="1368" href="A201706.IMCLP.html#275" class="InductiveConstructor">BOX</a> <a id="1372" href="A201706.IMCLP.html#1372" class="Bound">M</a><a id="1373" class="Symbol">)</a>     <a id="1379" class="Symbol">=</a> <a id="1381" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="1388" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1397" class="Symbol">(</a><a id="1398" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="1404" href="A201706.IMCLP.html#1404" class="Bound">M</a> <a id="1406" href="A201706.IMCLP.html#1406" class="Bound">N</a><a id="1407" class="Symbol">)</a> <a id="1409" class="Symbol">=</a> <a id="1411" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1417" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="1423" class="Symbol">(</a><a id="1424" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1433" href="A201706.IMCLP.html#1404" class="Bound">M</a><a id="1434" class="Symbol">)</a> <a id="1436" class="Symbol">(</a><a id="1437" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1446" href="A201706.IMCLP.html#1406" class="Bound">N</a><a id="1447" class="Symbol">)</a>

  <a id="idmonoTm⋆"></a><a id="1452" href="A201706.IMCLP.html#1452" class="Function">idmonoTm⋆</a> <a id="1462" class="Symbol">:</a> <a id="1464" class="Symbol">∀</a> <a id="1466" class="Symbol">{</a><a id="1467" href="A201706.IMCLP.html#1467" class="Bound">d</a> <a id="1469" href="A201706.IMCLP.html#1469" class="Bound">g</a> <a id="1471" href="A201706.IMCLP.html#1471" class="Bound">n</a><a id="1472" class="Symbol">}</a> <a id="1474" class="Symbol">→</a> <a id="1476" class="Symbol">(</a><a id="1477" href="A201706.IMCLP.html#1477" class="Bound">x</a> <a id="1479" class="Symbol">:</a> <a id="1481" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="1485" href="A201706.IMCLP.html#1467" class="Bound">d</a> <a id="1487" href="A201706.IMCLP.html#1469" class="Bound">g</a> <a id="1489" href="A201706.IMCLP.html#1471" class="Bound">n</a><a id="1490" class="Symbol">)</a> <a id="1492" class="Symbol">→</a> <a id="1494" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="1502" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1508" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1514" href="A201706.IMCLP.html#1477" class="Bound">x</a> <a id="1516" href="Agda.Builtin.Equality.html#125" class="Datatype Operator">≡</a> <a id="1518" href="A201706.IMCLP.html#1477" class="Bound">x</a>
  <a id="1522" href="A201706.IMCLP.html#1452" class="Function">idmonoTm⋆</a> <a id="1532" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>       <a id="1540" class="Symbol">=</a> <a id="1542" href="Agda.Builtin.Equality.html#182" class="InductiveConstructor">refl</a>
  <a id="1549" href="A201706.IMCLP.html#1452" class="Function">idmonoTm⋆</a> <a id="1559" class="Symbol">(</a><a id="1560" href="A201706.IMCLP.html#1560" class="Bound">x</a> <a id="1562" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1564" href="A201706.IMCLP.html#1564" class="Bound">M</a><a id="1565" class="Symbol">)</a> <a id="1567" class="Symbol">=</a> <a id="1569" href="A201706.Prelude.html#1362" class="Function">cong²</a> <a id="1575" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">_,_</a> <a id="1579" class="Symbol">(</a><a id="1580" href="A201706.IMCLP.html#1452" class="Function">idmonoTm⋆</a> <a id="1590" href="A201706.IMCLP.html#1560" class="Bound">x</a><a id="1591" class="Symbol">)</a> <a id="1593" class="Symbol">(</a><a id="1594" href="A201706.IMCLP.html#1075" class="Function">idmonoTm</a> <a id="1603" href="A201706.IMCLP.html#1564" class="Bound">M</a><a id="1604" class="Symbol">)</a>

<a id="reflTm⋆"></a><a id="1607" href="A201706.IMCLP.html#1607" class="Function">reflTm⋆</a> <a id="1615" class="Symbol">:</a> <a id="1617" class="Symbol">∀</a> <a id="1619" class="Symbol">{</a><a id="1620" href="A201706.IMCLP.html#1620" class="Bound">d</a> <a id="1622" href="A201706.IMCLP.html#1622" class="Bound">g</a><a id="1623" class="Symbol">}</a> <a id="1625" class="Symbol">→</a> <a id="1627" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="1631" href="A201706.IMCLP.html#1620" class="Bound">d</a> <a id="1633" href="A201706.IMCLP.html#1622" class="Bound">g</a> <a id="1635" href="A201706.IMCLP.html#1622" class="Bound">g</a>
<a id="1637" href="A201706.IMCLP.html#1607" class="Function">reflTm⋆</a> <a id="1645" class="Symbol">{</a><a id="1646" class="Argument">g</a> <a id="1648" class="Symbol">=</a> <a id="1650" href="Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a><a id="1654" class="Symbol">}</a>  <a id="1657" class="Symbol">=</a> <a id="1659" href="A201706.PreludeVec.html#160" class="InductiveConstructor">∅</a>
<a id="1661" href="A201706.IMCLP.html#1607" class="Function">reflTm⋆</a> <a id="1669" class="Symbol">{</a><a id="1670" class="Argument">g</a> <a id="1672" class="Symbol">=</a> <a id="1674" href="Agda.Builtin.Nat.html#196" class="InductiveConstructor">suc</a> <a id="1678" href="A201706.IMCLP.html#1678" class="Bound">g</a><a id="1679" class="Symbol">}</a> <a id="1681" class="Symbol">=</a> <a id="1683" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="1691" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="1697" class="Symbol">(</a><a id="1698" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="1703" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="1708" class="Symbol">)</a> <a id="1710" href="A201706.IMCLP.html#1607" class="Function">reflTm⋆</a> <a id="1718" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="1720" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="1724" href="A201706.Prelude.html#8767" class="InductiveConstructor">zero</a>

<a id="1730" class="Comment">-- TODO: What is going on here?</a>
<a id="1762" class="Comment">-- mreflTm⋆ : ∀ {d g} → Tm⋆ d g d</a>
<a id="1796" class="Comment">-- mreflTm⋆ {zero}  = ∅</a>
<a id="1820" class="Comment">-- mreflTm⋆ {suc d} =</a>
<a id="1842" class="Comment">--   monoTm⋆ (weak refl≥) refl≥ mreflTm⋆ ,</a>
<a id="1885" class="Comment">--   MVAR (monoTm⋆ (weak refl≥) done {!!}) zero</a>

<a id="lookupTm"></a><a id="1934" href="A201706.IMCLP.html#1934" class="Function">lookupTm</a> <a id="1943" class="Symbol">:</a> <a id="1945" class="Symbol">∀</a> <a id="1947" class="Symbol">{</a><a id="1948" href="A201706.IMCLP.html#1948" class="Bound">d</a> <a id="1950" href="A201706.IMCLP.html#1950" class="Bound">g</a> <a id="1952" href="A201706.IMCLP.html#1952" class="Bound">n</a><a id="1953" class="Symbol">}</a> <a id="1955" class="Symbol">→</a> <a id="1957" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="1961" href="A201706.IMCLP.html#1948" class="Bound">d</a> <a id="1963" href="A201706.IMCLP.html#1950" class="Bound">g</a> <a id="1965" href="A201706.IMCLP.html#1952" class="Bound">n</a> <a id="1967" class="Symbol">→</a> <a id="1969" href="A201706.Prelude.html#8743" class="Datatype">Fin</a> <a id="1973" href="A201706.IMCLP.html#1952" class="Bound">n</a> <a id="1975" class="Symbol">→</a> <a id="1977" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="1980" href="A201706.IMCLP.html#1948" class="Bound">d</a> <a id="1982" href="A201706.IMCLP.html#1950" class="Bound">g</a>
<a id="1984" href="A201706.IMCLP.html#1934" class="Function">lookupTm</a> <a id="1993" href="A201706.IMCLP.html#1993" class="Bound">x</a> <a id="1995" href="A201706.IMCLP.html#1995" class="Bound">i</a> <a id="1997" class="Symbol">=</a> <a id="1999" href="A201706.PreludeVec.html#291" class="Function">lookup</a> <a id="2006" href="A201706.IMCLP.html#1993" class="Bound">x</a> <a id="2008" href="A201706.IMCLP.html#1995" class="Bound">i</a>

<a id="graftTm"></a><a id="2011" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2019" class="Symbol">:</a> <a id="2021" class="Symbol">∀</a> <a id="2023" class="Symbol">{</a><a id="2024" href="A201706.IMCLP.html#2024" class="Bound">d</a> <a id="2026" href="A201706.IMCLP.html#2026" class="Bound">g</a> <a id="2028" href="A201706.IMCLP.html#2028" class="Bound">`g</a><a id="2030" class="Symbol">}</a> <a id="2032" class="Symbol">→</a> <a id="2034" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2038" href="A201706.IMCLP.html#2024" class="Bound">d</a> <a id="2040" href="A201706.IMCLP.html#2026" class="Bound">g</a> <a id="2042" href="A201706.IMCLP.html#2028" class="Bound">`g</a> <a id="2045" class="Symbol">→</a> <a id="2047" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="2050" href="A201706.IMCLP.html#2024" class="Bound">d</a> <a id="2052" href="A201706.IMCLP.html#2028" class="Bound">`g</a> <a id="2055" class="Symbol">→</a> <a id="2057" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="2060" href="A201706.IMCLP.html#2024" class="Bound">d</a> <a id="2062" href="A201706.IMCLP.html#2026" class="Bound">g</a>
<a id="2064" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2072" href="A201706.IMCLP.html#2072" class="Bound">p</a> <a id="2074" class="Symbol">(</a><a id="2075" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="2079" href="A201706.IMCLP.html#2079" class="Bound">i</a><a id="2080" class="Symbol">)</a>     <a id="2086" class="Symbol">=</a> <a id="2088" href="A201706.IMCLP.html#1934" class="Function">lookupTm</a> <a id="2097" href="A201706.IMCLP.html#2072" class="Bound">p</a> <a id="2099" href="A201706.IMCLP.html#2079" class="Bound">i</a>
<a id="2101" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2109" href="A201706.IMCLP.html#2109" class="Bound">p</a> <a id="2111" class="Symbol">(</a><a id="2112" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a> <a id="2117" href="A201706.IMCLP.html#2117" class="Bound">q</a> <a id="2119" href="A201706.IMCLP.html#2119" class="Bound">i</a><a id="2120" class="Symbol">)</a>  <a id="2123" class="Symbol">=</a> <a id="2125" href="A201706.IMCLP.html#152" class="InductiveConstructor">MVAR</a> <a id="2130" href="A201706.IMCLP.html#2117" class="Bound">q</a> <a id="2132" href="A201706.IMCLP.html#2119" class="Bound">i</a>
<a id="2134" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2142" href="A201706.IMCLP.html#2142" class="Bound">p</a> <a id="2144" class="Symbol">(</a><a id="2145" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a> <a id="2149" href="A201706.IMCLP.html#2149" class="Bound">M</a><a id="2150" class="Symbol">)</a>     <a id="2156" class="Symbol">=</a> <a id="2158" href="A201706.IMCLP.html#204" class="InductiveConstructor">LAM</a> <a id="2162" class="Symbol">(</a><a id="2163" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2171" class="Symbol">(</a><a id="2172" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="2180" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="2186" class="Symbol">(</a><a id="2187" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="2192" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="2197" class="Symbol">)</a> <a id="2199" href="A201706.IMCLP.html#2142" class="Bound">p</a> <a id="2201" href="A201706.PreludeVec.html#179" class="InductiveConstructor Operator">,</a> <a id="2203" href="A201706.IMCLP.html#125" class="InductiveConstructor">VAR</a> <a id="2207" href="A201706.Prelude.html#8767" class="InductiveConstructor">zero</a><a id="2211" class="Symbol">)</a> <a id="2213" href="A201706.IMCLP.html#2149" class="Bound">M</a><a id="2214" class="Symbol">)</a>
<a id="2216" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2224" href="A201706.IMCLP.html#2224" class="Bound">p</a> <a id="2226" class="Symbol">(</a><a id="2227" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a> <a id="2231" href="A201706.IMCLP.html#2231" class="Bound">M</a> <a id="2233" href="A201706.IMCLP.html#2233" class="Bound">N</a><a id="2234" class="Symbol">)</a>   <a id="2238" class="Symbol">=</a> <a id="2240" href="A201706.IMCLP.html#238" class="InductiveConstructor">APP</a> <a id="2244" class="Symbol">(</a><a id="2245" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2253" href="A201706.IMCLP.html#2224" class="Bound">p</a> <a id="2255" href="A201706.IMCLP.html#2231" class="Bound">M</a><a id="2256" class="Symbol">)</a> <a id="2258" class="Symbol">(</a><a id="2259" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2267" href="A201706.IMCLP.html#2224" class="Bound">p</a> <a id="2269" href="A201706.IMCLP.html#2233" class="Bound">N</a><a id="2270" class="Symbol">)</a>
<a id="2272" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2280" href="A201706.IMCLP.html#2280" class="Bound">p</a> <a id="2282" class="Symbol">(</a><a id="2283" href="A201706.IMCLP.html#275" class="InductiveConstructor">BOX</a> <a id="2287" href="A201706.IMCLP.html#2287" class="Bound">M</a><a id="2288" class="Symbol">)</a>     <a id="2294" class="Symbol">=</a> <a id="2296" href="A201706.IMCLP.html#275" class="InductiveConstructor">BOX</a> <a id="2300" href="A201706.IMCLP.html#2287" class="Bound">M</a>
<a id="2302" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2310" href="A201706.IMCLP.html#2310" class="Bound">p</a> <a id="2312" class="Symbol">(</a><a id="2313" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="2319" href="A201706.IMCLP.html#2319" class="Bound">M</a> <a id="2321" href="A201706.IMCLP.html#2321" class="Bound">N</a><a id="2322" class="Symbol">)</a> <a id="2324" class="Symbol">=</a> <a id="2326" href="A201706.IMCLP.html#316" class="InductiveConstructor">UNBOX</a> <a id="2332" class="Symbol">(</a><a id="2333" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2341" href="A201706.IMCLP.html#2310" class="Bound">p</a> <a id="2343" href="A201706.IMCLP.html#2319" class="Bound">M</a><a id="2344" class="Symbol">)</a> <a id="2346" class="Symbol">(</a><a id="2347" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2355" class="Symbol">(</a><a id="2356" href="A201706.IMCLP.html#816" class="Function">monoTm⋆</a> <a id="2364" class="Symbol">(</a><a id="2365" href="A201706.Prelude.html#6679" class="InductiveConstructor">weak</a> <a id="2370" href="A201706.Prelude.html#7585" class="Function">refl≥</a><a id="2375" class="Symbol">)</a> <a id="2377" href="A201706.Prelude.html#7585" class="Function">refl≥</a> <a id="2383" href="A201706.IMCLP.html#2310" class="Bound">p</a><a id="2384" class="Symbol">)</a> <a id="2386" href="A201706.IMCLP.html#2321" class="Bound">N</a><a id="2387" class="Symbol">)</a>

<a id="graftTm⋆"></a><a id="2390" href="A201706.IMCLP.html#2390" class="Function">graftTm⋆</a> <a id="2399" class="Symbol">:</a> <a id="2401" class="Symbol">∀</a> <a id="2403" class="Symbol">{</a><a id="2404" href="A201706.IMCLP.html#2404" class="Bound">d</a> <a id="2406" href="A201706.IMCLP.html#2406" class="Bound">g</a> <a id="2408" href="A201706.IMCLP.html#2408" class="Bound">`g</a> <a id="2411" href="A201706.IMCLP.html#2411" class="Bound">n</a><a id="2412" class="Symbol">}</a> <a id="2414" class="Symbol">→</a> <a id="2416" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2420" href="A201706.IMCLP.html#2404" class="Bound">d</a> <a id="2422" href="A201706.IMCLP.html#2406" class="Bound">g</a> <a id="2424" href="A201706.IMCLP.html#2408" class="Bound">`g</a> <a id="2427" class="Symbol">→</a> <a id="2429" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2433" href="A201706.IMCLP.html#2404" class="Bound">d</a> <a id="2435" href="A201706.IMCLP.html#2408" class="Bound">`g</a> <a id="2438" href="A201706.IMCLP.html#2411" class="Bound">n</a> <a id="2440" class="Symbol">→</a> <a id="2442" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2446" href="A201706.IMCLP.html#2404" class="Bound">d</a> <a id="2448" href="A201706.IMCLP.html#2406" class="Bound">g</a> <a id="2450" href="A201706.IMCLP.html#2411" class="Bound">n</a>
<a id="2452" href="A201706.IMCLP.html#2390" class="Function">graftTm⋆</a> <a id="2461" href="A201706.IMCLP.html#2461" class="Bound">p</a> <a id="2463" href="A201706.IMCLP.html#2463" class="Bound">x</a> <a id="2465" class="Symbol">=</a> <a id="2467" href="A201706.PreludeVec.html#426" class="Function">map</a> <a id="2471" class="Symbol">(</a><a id="2472" href="A201706.IMCLP.html#2011" class="Function">graftTm</a> <a id="2480" href="A201706.IMCLP.html#2461" class="Bound">p</a><a id="2481" class="Symbol">)</a> <a id="2483" href="A201706.IMCLP.html#2463" class="Bound">x</a>

<a id="transTm"></a><a id="2486" href="A201706.IMCLP.html#2486" class="Function">transTm</a> <a id="2494" class="Symbol">:</a> <a id="2496" class="Symbol">∀</a> <a id="2498" class="Symbol">{</a><a id="2499" href="A201706.IMCLP.html#2499" class="Bound">d</a> <a id="2501" href="A201706.IMCLP.html#2501" class="Bound">g</a> <a id="2503" href="A201706.IMCLP.html#2503" class="Bound">g′</a> <a id="2506" href="A201706.IMCLP.html#2506" class="Bound">g″</a><a id="2508" class="Symbol">}</a> <a id="2510" class="Symbol">→</a> <a id="2512" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2516" href="A201706.IMCLP.html#2499" class="Bound">d</a> <a id="2518" href="A201706.IMCLP.html#2506" class="Bound">g″</a> <a id="2521" href="A201706.IMCLP.html#2503" class="Bound">g′</a> <a id="2524" class="Symbol">→</a> <a id="2526" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2530" href="A201706.IMCLP.html#2499" class="Bound">d</a> <a id="2532" href="A201706.IMCLP.html#2503" class="Bound">g′</a> <a id="2535" href="A201706.IMCLP.html#2501" class="Bound">g</a> <a id="2537" class="Symbol">→</a> <a id="2539" href="A201706.IMCLP.html#358" class="Function">Tm⋆</a> <a id="2543" href="A201706.IMCLP.html#2499" class="Bound">d</a> <a id="2545" href="A201706.IMCLP.html#2506" class="Bound">g″</a> <a id="2548" href="A201706.IMCLP.html#2501" class="Bound">g</a>
<a id="2550" href="A201706.IMCLP.html#2486" class="Function">transTm</a> <a id="2558" class="Symbol">=</a> <a id="2560" href="A201706.IMCLP.html#2390" class="Function">graftTm⋆</a>

<a id="2570" class="Comment">-- TODO: What is going on here?</a>
<a id="2602" class="Comment">-- mutual</a>
<a id="2612" class="Comment">--   mgraftTm : ∀ {d g `d} → Tm⋆ d zero `d → Tm `d g → Tm d g</a>
<a id="2674" class="Comment">--   mgraftTm q (VAR i)     = VAR i</a>
<a id="2710" class="Comment">--   mgraftTm q (MVAR q′ i) = UNBOX (monoTm refl≥ inf≥ (lookupTm q i))</a>
<a id="2781" class="Comment">--                                  (MVAR (mgraftTm⋆ (monoTm⋆ (weak refl≥) refl≥ q) q′) zero)</a>
<a id="2875" class="Comment">--   mgraftTm q (LAM M)     = LAM (mgraftTm q M)</a>
<a id="2924" class="Comment">--   mgraftTm q (APP M N)   = APP (mgraftTm q M) (mgraftTm q N)</a>
<a id="2988" class="Comment">--   mgraftTm q (BOX M)     = BOX M</a>
<a id="3024" class="Comment">--   mgraftTm q (UNBOX M N) =</a>
<a id="3054" class="Comment">--     UNBOX (mgraftTm q M)</a>
<a id="3082" class="Comment">--           (mgraftTm (monoTm⋆ (weak refl≥) refl≥ q ,</a>
<a id="3137" class="Comment">--                      BOX (MVAR {!!} zero)) N)</a>
<a id="3186" class="Comment">--</a>
<a id="3189" class="Comment">--   mgraftTm⋆ : ∀ {d g `d n} → Tm⋆ d zero `d → Tm⋆ `d g n → Tm⋆ d g n</a>
<a id="3260" class="Comment">--   mgraftTm⋆ q ∅       = ∅</a>
<a id="3289" class="Comment">--   mgraftTm⋆ q (x , M) = mgraftTm⋆ q x , mgraftTm q M</a>
<a id="3345" class="Comment">--</a>
<a id="3348" class="Comment">-- mtransTm⋆ : ∀ {d d′ d″} → Tm⋆ d″ zero d′ → Tm⋆ d′ zero d → Tm⋆ d″ zero d</a>
<a id="3424" class="Comment">-- mtransTm⋆ = mgraftTm⋆</a>


<a id="3451" class="Comment">-- Types and vectors of types.</a>

<a id="3483" class="Keyword">mutual</a>
  <a id="3492" class="Keyword">infixr</a> <a id="3499" class="Number">7</a> <a id="3501" href="A201706.IMCLP.html#3547" class="InductiveConstructor Operator">_⇒_</a>
  <a id="3507" class="Keyword">data</a> <a id="Ty"></a><a id="3512" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a> <a id="3515" class="Symbol">:</a> <a id="3517" class="PrimitiveType">Set</a> <a id="3521" class="Keyword">where</a>
    <a id="Ty.•"></a><a id="3531" href="A201706.IMCLP.html#3531" class="InductiveConstructor">•</a>      <a id="3538" class="Symbol">:</a> <a id="3540" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a>
    <a id="Ty._⇒_"></a><a id="3547" href="A201706.IMCLP.html#3547" class="InductiveConstructor Operator">_⇒_</a>   <a id="3553" class="Symbol">:</a> <a id="3555" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a> <a id="3558" class="Symbol">→</a> <a id="3560" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a> <a id="3563" class="Symbol">→</a> <a id="3565" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a>
    <a id="Ty.[_⊦_]_"></a><a id="3572" href="A201706.IMCLP.html#3572" class="InductiveConstructor Operator">[_⊦_]_</a> <a id="3579" class="Symbol">:</a> <a id="3581" class="Symbol">∀</a> <a id="3583" class="Symbol">{</a><a id="3584" href="A201706.IMCLP.html#3584" class="Bound">d</a><a id="3585" class="Symbol">}</a> <a id="3587" class="Symbol">→</a> <a id="3589" href="A201706.IMCLP.html#3810" class="Function">BoxTy⋆</a> <a id="3596" href="A201706.IMCLP.html#3584" class="Bound">d</a> <a id="3598" class="Symbol">→</a> <a id="3600" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="3603" href="A201706.IMCLP.html#3584" class="Bound">d</a> <a id="3605" href="Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a> <a id="3610" class="Symbol">→</a> <a id="3612" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a> <a id="3615" class="Symbol">→</a> <a id="3617" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a>

  <a id="3623" class="Keyword">record</a> <a id="BoxTy"></a><a id="3630" href="A201706.IMCLP.html#3630" class="Record">BoxTy</a> <a id="3636" class="Symbol">:</a> <a id="3638" class="PrimitiveType">Set</a> <a id="3642" class="Keyword">where</a>
    <a id="3652" class="Keyword">inductive</a>
    <a id="3666" class="Keyword">constructor</a> <a id="BoxTy.[_⊦_]_"></a><a id="3678" href="A201706.IMCLP.html#3678" class="InductiveConstructor Operator">[_⊦_]_</a>
    <a id="3689" class="Keyword">field</a>
      <a id="3701" class="Symbol">{</a><a id="BoxTy.d"></a><a id="3702" href="A201706.IMCLP.html#3702" class="Field">d</a><a id="3703" class="Symbol">}</a> <a id="3705" class="Symbol">:</a> <a id="3707" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a>
      <a id="BoxTy.Δ"></a><a id="3717" href="A201706.IMCLP.html#3717" class="Field">Δ</a>   <a id="3721" class="Symbol">:</a> <a id="3723" href="A201706.IMCLP.html#3810" class="Function">BoxTy⋆</a> <a id="3730" href="A201706.IMCLP.html#3702" class="Field">d</a>
      <a id="BoxTy.M"></a><a id="3738" href="A201706.IMCLP.html#3738" class="Field">M</a>   <a id="3742" class="Symbol">:</a> <a id="3744" href="A201706.IMCLP.html#94" class="Datatype">Tm</a> <a id="3747" href="A201706.IMCLP.html#3702" class="Field">d</a> <a id="3749" href="Agda.Builtin.Nat.html#183" class="InductiveConstructor">zero</a>
      <a id="BoxTy.A"></a><a id="3760" href="A201706.IMCLP.html#3760" class="Field">A</a>   <a id="3764" class="Symbol">:</a> <a id="3766" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a>

  <a id="Ty⋆"></a><a id="3772" href="A201706.IMCLP.html#3772" class="Function">Ty⋆</a> <a id="3776" class="Symbol">:</a> <a id="3778" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a> <a id="3782" class="Symbol">→</a> <a id="3784" class="PrimitiveType">Set</a>
  <a id="3790" href="A201706.IMCLP.html#3772" class="Function">Ty⋆</a> <a id="3794" href="A201706.IMCLP.html#3794" class="Bound">g</a> <a id="3796" class="Symbol">=</a> <a id="3798" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="3802" href="A201706.IMCLP.html#3512" class="Datatype">Ty</a> <a id="3805" href="A201706.IMCLP.html#3794" class="Bound">g</a>

  <a id="BoxTy⋆"></a><a id="3810" href="A201706.IMCLP.html#3810" class="Function">BoxTy⋆</a> <a id="3817" class="Symbol">:</a> <a id="3819" href="Agda.Builtin.Nat.html#165" class="Datatype">Nat</a> <a id="3823" class="Symbol">→</a> <a id="3825" class="PrimitiveType">Set</a>
  <a id="3831" href="A201706.IMCLP.html#3810" class="Function">BoxTy⋆</a> <a id="3838" href="A201706.IMCLP.html#3838" class="Bound">d</a> <a id="3840" class="Symbol">=</a> <a id="3842" href="A201706.PreludeVec.html#118" class="Datatype">Vec</a> <a id="3846" href="A201706.IMCLP.html#3630" class="Record">BoxTy</a> <a id="3852" href="A201706.IMCLP.html#3838" class="Bound">d</a>
</pre></body></html>