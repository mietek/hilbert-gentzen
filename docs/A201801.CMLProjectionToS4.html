<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201801.CMLProjectionToS4</title><link rel="stylesheet" href="AgdaPP.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--rewriting</a> <a id="25" class="Symbol">#-}</a>

<a id="30" class="Keyword">module</a> <a id="37" href="A201801.CMLProjectionToS4.html" class="Module">A201801.CMLProjectionToS4</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="98" class="Keyword">open</a> <a id="103" class="Keyword">import</a> <a id="110" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="A201801.List.html" class="Module">A201801.List</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="A201801.ListLemmas.html" class="Module">A201801.ListLemmas</a>
<a id="183" class="Keyword">open</a> <a id="188" class="Keyword">import</a> <a id="195" href="A201801.ListConcatenation.html" class="Module">A201801.ListConcatenation</a>
<a id="221" class="Keyword">open</a> <a id="226" class="Keyword">import</a> <a id="233" href="A201801.AllList.html" class="Module">A201801.AllList</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="A201801.CMLPropositions.html" class="Module">A201801.CMLPropositions</a>
<a id="285" class="Comment">-- open import CMLDerivations</a>
<a id="315" class="Keyword">import</a> <a id="322" href="A201801.S4Propositions.html" class="Module">A201801.S4Propositions</a> <a id="345" class="Symbol">as</a> <a id="348" class="Module">S4</a>
<a id="351" class="Comment">-- import S4Derivations as S4</a>


<a id="383" class="Comment">--------------------------------------------------------------------------------</a>


<a id="466" class="Keyword">mutual</a>
  <a id="⟦_⟧ₚ"></a><a id="475" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦_⟧ₚ</a> <a id="480" class="Symbol">:</a> <a id="482" href="A201801.CMLPropositions.html#224" class="Datatype">Form</a> <a id="487" class="Symbol">→</a> <a id="489" href="A201801.S4Propositions.html#223" class="Datatype">S4.Form</a>
  <a id="499" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="501" href="A201801.CMLPropositions.html#247" class="InductiveConstructor Operator">ι</a> <a id="503" href="A201801.CMLProjectionToS4.html#503" class="Bound">P</a> <a id="505" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a>     <a id="512" class="Symbol">=</a> <a id="514" href="A201801.S4Propositions.html#246" class="InductiveConstructor Operator">S4.ι</a> <a id="519" href="A201801.CMLProjectionToS4.html#503" class="Bound">P</a>
  <a id="523" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="525" href="A201801.CMLProjectionToS4.html#525" class="Bound">A</a> <a id="527" href="A201801.CMLPropositions.html#272" class="InductiveConstructor Operator">⊃</a> <a id="529" href="A201801.CMLProjectionToS4.html#529" class="Bound">B</a> <a id="531" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a>   <a id="536" class="Symbol">=</a> <a id="538" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="540" href="A201801.CMLProjectionToS4.html#525" class="Bound">A</a> <a id="542" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a> <a id="545" href="A201801.S4Propositions.html#270" class="InductiveConstructor Operator">S4.⊃</a> <a id="550" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="552" href="A201801.CMLProjectionToS4.html#529" class="Bound">B</a> <a id="554" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a>
  <a id="559" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="561" href="A201801.CMLPropositions.html#302" class="InductiveConstructor Operator">[</a> <a id="563" href="A201801.CMLProjectionToS4.html#563" class="Bound">Ψ</a> <a id="565" href="A201801.CMLPropositions.html#302" class="InductiveConstructor Operator">]</a> <a id="567" href="A201801.CMLProjectionToS4.html#567" class="Bound">A</a> <a id="569" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a> <a id="572" class="Symbol">=</a> <a id="574" href="A201801.S4Propositions.html#299" class="InductiveConstructor Operator">S4.□</a> <a id="579" class="Symbol">(</a><a id="580" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="582" href="A201801.CMLProjectionToS4.html#563" class="Bound">Ψ</a> <a id="584" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a> <a id="588" href="A201801.S4Propositions.html#1880" class="Function Operator">S4.⊃⋯⊃</a> <a id="595" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="597" href="A201801.CMLProjectionToS4.html#567" class="Bound">A</a> <a id="599" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a><a id="601" class="Symbol">)</a>

  <a id="⟦_⟧ₚₛ"></a><a id="606" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦_⟧ₚₛ</a> <a id="612" class="Symbol">:</a> <a id="614" href="A201801.List.html#199" class="Datatype">List</a> <a id="619" href="A201801.CMLPropositions.html#224" class="Datatype">Form</a> <a id="624" class="Symbol">→</a> <a id="626" href="A201801.List.html#199" class="Datatype">List</a> <a id="631" href="A201801.S4Propositions.html#223" class="Datatype">S4.Form</a>
  <a id="641" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="643" href="A201801.List.html#232" class="InductiveConstructor">∙</a> <a id="645" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a>     <a id="653" class="Symbol">=</a> <a id="655" href="A201801.List.html#232" class="InductiveConstructor">∙</a>
  <a id="659" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="661" href="A201801.CMLProjectionToS4.html#661" class="Bound">Ξ</a> <a id="663" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="665" href="A201801.CMLProjectionToS4.html#665" class="Bound">A</a> <a id="667" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a> <a id="671" class="Symbol">=</a> <a id="673" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="675" href="A201801.CMLProjectionToS4.html#661" class="Bound">Ξ</a> <a id="677" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a> <a id="681" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="683" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="685" href="A201801.CMLProjectionToS4.html#665" class="Bound">A</a> <a id="687" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a>


<a id="⟦_⟧ₐ"></a><a id="692" href="A201801.CMLProjectionToS4.html#692" class="Function Operator">⟦_⟧ₐ</a> <a id="697" class="Symbol">:</a> <a id="699" href="A201801.CMLPropositions.html#553" class="Record">Assert</a> <a id="706" class="Symbol">→</a> <a id="708" href="A201801.S4Propositions.html#537" class="Record">S4.Assert</a>
<a id="718" href="A201801.CMLProjectionToS4.html#692" class="Function Operator">⟦</a> <a id="720" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">⟪</a> <a id="722" href="A201801.CMLProjectionToS4.html#722" class="Bound">Γ</a> <a id="724" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">⊫</a> <a id="726" href="A201801.CMLProjectionToS4.html#726" class="Bound">A</a> <a id="728" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">⟫</a> <a id="730" href="A201801.CMLProjectionToS4.html#692" class="Function Operator">⟧ₐ</a> <a id="733" class="Symbol">=</a> <a id="735" href="A201801.S4Propositions.html#574" class="InductiveConstructor Operator">S4.⟪⊫</a> <a id="741" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="743" href="A201801.CMLProjectionToS4.html#722" class="Bound">Γ</a> <a id="745" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a> <a id="749" href="A201801.S4Propositions.html#1880" class="Function Operator">S4.⊃⋯⊃</a> <a id="756" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="758" href="A201801.CMLProjectionToS4.html#726" class="Bound">A</a> <a id="760" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a> <a id="763" href="A201801.S4Propositions.html#574" class="InductiveConstructor Operator">⟫</a>


<a id="⟦_⟧ₐₛ"></a><a id="767" href="A201801.CMLProjectionToS4.html#767" class="Function Operator">⟦_⟧ₐₛ</a> <a id="773" class="Symbol">:</a> <a id="775" href="A201801.List.html#199" class="Datatype">List</a> <a id="780" href="A201801.CMLPropositions.html#553" class="Record">Assert</a> <a id="787" class="Symbol">→</a> <a id="789" href="A201801.List.html#199" class="Datatype">List</a> <a id="794" href="A201801.S4Propositions.html#537" class="Record">S4.Assert</a>
<a id="804" href="A201801.CMLProjectionToS4.html#767" class="Function Operator">⟦</a> <a id="806" href="A201801.CMLProjectionToS4.html#806" class="Bound">Δ</a> <a id="808" href="A201801.CMLProjectionToS4.html#767" class="Function Operator">⟧ₐₛ</a> <a id="812" class="Symbol">=</a> <a id="814" href="A201801.List.html#363" class="Function">map</a> <a id="818" href="A201801.CMLProjectionToS4.html#692" class="Function Operator">⟦_⟧ₐ</a> <a id="823" href="A201801.CMLProjectionToS4.html#806" class="Bound">Δ</a>


<a id="⟦_⟧∋ₚ"></a><a id="827" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟦_⟧∋ₚ</a> <a id="833" class="Symbol">:</a> <a id="835" class="Symbol">∀</a> <a id="837" class="Symbol">{</a><a id="838" href="A201801.CMLProjectionToS4.html#838" class="Bound">Γ</a> <a id="840" href="A201801.CMLProjectionToS4.html#840" class="Bound">A</a><a id="841" class="Symbol">}</a> <a id="843" class="Symbol">→</a> <a id="845" href="A201801.CMLProjectionToS4.html#838" class="Bound">Γ</a> <a id="847" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="849" href="A201801.CMLProjectionToS4.html#840" class="Bound">A</a>
                <a id="867" class="Symbol">→</a> <a id="869" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="871" href="A201801.CMLProjectionToS4.html#838" class="Bound">Γ</a> <a id="873" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a> <a id="877" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="879" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="881" href="A201801.CMLProjectionToS4.html#840" class="Bound">A</a> <a id="883" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a>
<a id="886" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟦</a> <a id="888" href="A201801.List.html#2379" class="InductiveConstructor">zero</a> <a id="893" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟧∋ₚ</a>  <a id="898" class="Symbol">=</a> <a id="900" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>
<a id="905" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟦</a> <a id="907" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="911" href="A201801.CMLProjectionToS4.html#911" class="Bound">i</a> <a id="913" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟧∋ₚ</a> <a id="917" class="Symbol">=</a> <a id="919" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="923" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟦</a> <a id="925" href="A201801.CMLProjectionToS4.html#911" class="Bound">i</a> <a id="927" href="A201801.CMLProjectionToS4.html#827" class="Function Operator">⟧∋ₚ</a>


<a id="⟦_⟧∋ₐ"></a><a id="933" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟦_⟧∋ₐ</a> <a id="939" class="Symbol">:</a> <a id="941" class="Symbol">∀</a> <a id="943" class="Symbol">{</a><a id="944" href="A201801.CMLProjectionToS4.html#944" class="Bound">Δ</a> <a id="946" href="A201801.CMLProjectionToS4.html#946" class="Bound">Γ</a> <a id="948" href="A201801.CMLProjectionToS4.html#948" class="Bound">A</a><a id="949" class="Symbol">}</a> <a id="951" class="Symbol">→</a> <a id="953" href="A201801.CMLProjectionToS4.html#944" class="Bound">Δ</a> <a id="955" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="957" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">⟪</a> <a id="959" href="A201801.CMLProjectionToS4.html#946" class="Bound">Γ</a> <a id="961" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">⊫</a> <a id="963" href="A201801.CMLProjectionToS4.html#948" class="Bound">A</a> <a id="965" href="A201801.CMLPropositions.html#590" class="InductiveConstructor Operator">⟫</a>
                  <a id="985" class="Symbol">→</a> <a id="987" href="A201801.CMLProjectionToS4.html#767" class="Function Operator">⟦</a> <a id="989" href="A201801.CMLProjectionToS4.html#944" class="Bound">Δ</a> <a id="991" href="A201801.CMLProjectionToS4.html#767" class="Function Operator">⟧ₐₛ</a> <a id="995" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="997" href="A201801.S4Propositions.html#574" class="InductiveConstructor Operator">S4.⟪⊫</a> <a id="1003" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟦</a> <a id="1005" href="A201801.CMLProjectionToS4.html#946" class="Bound">Γ</a> <a id="1007" href="A201801.CMLProjectionToS4.html#606" class="Function Operator">⟧ₚₛ</a> <a id="1011" href="A201801.S4Propositions.html#1880" class="Function Operator">S4.⊃⋯⊃</a> <a id="1018" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟦</a> <a id="1020" href="A201801.CMLProjectionToS4.html#948" class="Bound">A</a> <a id="1022" href="A201801.CMLProjectionToS4.html#475" class="Function Operator">⟧ₚ</a> <a id="1025" href="A201801.S4Propositions.html#574" class="InductiveConstructor Operator">⟫</a>
<a id="1027" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟦</a> <a id="1029" href="A201801.List.html#2379" class="InductiveConstructor">zero</a> <a id="1034" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟧∋ₐ</a>  <a id="1039" class="Symbol">=</a> <a id="1041" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>
<a id="1046" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟦</a> <a id="1048" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1052" href="A201801.CMLProjectionToS4.html#1052" class="Bound">i</a> <a id="1054" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟧∋ₐ</a> <a id="1058" class="Symbol">=</a> <a id="1060" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1064" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟦</a> <a id="1066" href="A201801.CMLProjectionToS4.html#1052" class="Bound">i</a> <a id="1068" href="A201801.CMLProjectionToS4.html#933" class="Function Operator">⟧∋ₐ</a>


<a id="1074" class="Comment">-- TODO: unfinished</a>
<a id="1094" class="Comment">-- mutual</a>
<a id="1104" class="Comment">--   ⟦_⟧ : ∀ {Δ Γ A} → Δ ⊢ A valid[ Γ ]</a>
<a id="1144" class="Comment">--                   → ⟦ Δ ⟧ₐₛ S4.⊢ ⟦ A ⟧ₚ valid[ ⟦ Γ ⟧ₚₛ ]</a>
<a id="1204" class="Comment">--   ⟦ var i ⟧         = S4.var ⟦ i ⟧∋ₚ</a>
<a id="1244" class="Comment">--   ⟦ lam 𝒟 ⟧         = S4.lam ⟦ 𝒟 ⟧</a>
<a id="1282" class="Comment">--   ⟦ app 𝒟 ℰ ⟧       = S4.app ⟦ 𝒟 ⟧ ⟦ ℰ ⟧</a>
<a id="1326" class="Comment">--   ⟦ mvar i ψ ⟧      = S4.apps (S4.mvar ⟦ i ⟧∋ₐ) ⟦ ψ ⟧ⁿ</a>
<a id="1384" class="Comment">--   ⟦ box {Ψ = Ψ} 𝒟 ⟧ = S4.box (S4.lams ⟦ Ψ ⟧ₚₛ ⟦ 𝒟 ⟧)</a>
<a id="1440" class="Comment">--   ⟦ letbox 𝒟 ℰ ⟧    = S4.letbox ⟦ 𝒟 ⟧ ⟦ ℰ ⟧</a>

<a id="1488" class="Comment">--   ⟦_⟧ⁿ : ∀ {Δ Γ Ξ} → Δ ⊢ Ξ allvalid[ Γ ]</a>
<a id="1532" class="Comment">--                    → ⟦ Δ ⟧ₐₛ S4.⊢ ⟦ Ξ ⟧ₚₛ allvalid[ ⟦ Γ ⟧ₚₛ ]</a>
<a id="1597" class="Comment">--   ⟦ ∙ ⟧ⁿ     = ∙</a>
<a id="1617" class="Comment">--   ⟦ ξ , 𝒟 ⟧ⁿ = ⟦ ξ ⟧ⁿ , ⟦ 𝒟 ⟧</a>


<a id="1652" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="1738" class="Comment">-- ↓ₚ : S4.Form → Form</a>
<a id="1761" class="Comment">-- ↓ₚ (S4.ι P)   = ι P</a>
<a id="1784" class="Comment">-- ↓ₚ (A S4.⊃ B) = (↓ₚ A) ⊃ (↓ₚ B)</a>
<a id="1819" class="Comment">-- ↓ₚ (S4.□ A)   = [ ∙ ] (↓ₚ A)</a>


<a id="1853" class="Comment">-- ↓ₚₛ : List S4.Form → List Form</a>
<a id="1887" class="Comment">-- ↓ₚₛ Γ = map ↓ₚ Γ</a>


<a id="1909" class="Comment">-- ↓ₐ : S4.Assert → Assert</a>
<a id="1936" class="Comment">-- ↓ₐ S4.⟪⊫ A ⟫ = ⟪ ∙ ⊫ ↓ₚ A ⟫</a>


<a id="1969" class="Comment">-- ↓ₐₛ : List S4.Assert → List Assert</a>
<a id="2007" class="Comment">-- ↓ₐₛ Δ = map ↓ₐ Δ</a>


<a id="2029" class="Comment">-- ↓∋ₚ : ∀ {Γ A} → Γ ∋ A</a>
<a id="2054" class="Comment">--               → ↓ₚₛ Γ ∋ ↓ₚ A</a>
<a id="2086" class="Comment">-- ↓∋ₚ zero    = zero</a>
<a id="2108" class="Comment">-- ↓∋ₚ (suc i) = suc (↓∋ₚ i)</a>


<a id="2139" class="Comment">-- ↓∋ₐ : ∀ {Δ A} → Δ ∋ S4.⟪⊫ A ⟫</a>
<a id="2172" class="Comment">--               → ↓ₐₛ Δ ∋ ⟪ ∙ ⊫ ↓ₚ A ⟫</a>
<a id="2212" class="Comment">-- ↓∋ₐ zero    = zero</a>
<a id="2234" class="Comment">-- ↓∋ₐ (suc i) = suc (↓∋ₐ i)</a>


<a id="2265" class="Comment">-- ↓ : ∀ {Δ Γ A} → Δ S4.⊢ A valid[ Γ ]</a>
<a id="2304" class="Comment">--               → ↓ₐₛ Δ ⊢ ↓ₚ A valid[ ↓ₚₛ Γ ]</a>
<a id="2351" class="Comment">-- ↓ (S4.var i)      = var (↓∋ₚ i)</a>
<a id="2386" class="Comment">-- ↓ (S4.lam 𝒟)      = lam (↓ 𝒟)</a>
<a id="2419" class="Comment">-- ↓ (S4.app 𝒟 ℰ)    = app (↓ 𝒟) (↓ ℰ)</a>
<a id="2458" class="Comment">-- ↓ (S4.mvar i)     = mvar (↓∋ₐ i) ∙</a>
<a id="2496" class="Comment">-- ↓ (S4.box 𝒟)      = box (↓ 𝒟)</a>
<a id="2529" class="Comment">-- ↓ (S4.letbox 𝒟 ℰ) = letbox (↓ 𝒟) (↓ ℰ)</a>


<a id="2573" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="2659" class="Comment">-- id⟦⟧↓ₚ : ∀ {A} → (⟦_⟧ₚ ∘ ↓ₚ) A ≡ A</a>
<a id="2697" class="Comment">-- id⟦⟧↓ₚ {S4.ι P}   = refl</a>
<a id="2725" class="Comment">-- id⟦⟧↓ₚ {A S4.⊃ B} = S4._⊃_ &amp; id⟦⟧↓ₚ ⊗ id⟦⟧↓ₚ</a>
<a id="2773" class="Comment">-- id⟦⟧↓ₚ {S4.□ A}   = S4.□_ &amp; id⟦⟧↓ₚ</a>


<a id="2813" class="Comment">-- id⟦⟧↓ₚₛ : ∀ {Γ} → (⟦_⟧ₚₛ ∘ ↓ₚₛ) Γ ≡ Γ</a>
<a id="2854" class="Comment">-- id⟦⟧↓ₚₛ {∙}     = refl</a>
<a id="2880" class="Comment">-- id⟦⟧↓ₚₛ {Γ , A} = _,_ &amp; id⟦⟧↓ₚₛ ⊗ id⟦⟧↓ₚ</a>


<a id="2926" class="Comment">-- id⟦⟧↓ₐ : ∀ {A} → (⟦_⟧ₐ ∘ ↓ₐ) S4.⟪⊫ A ⟫ ≡ S4.⟪⊫ A ⟫</a>
<a id="2980" class="Comment">-- id⟦⟧↓ₐ = S4.⟪⊫_⟫ &amp; id⟦⟧↓ₚ</a>


<a id="3011" class="Comment">-- -- NOTE: Agda does not accept this type for REWRITE</a>
<a id="3066" class="Comment">-- -- id⟦⟧↓ₐₛ : ∀ {Δ} → (⟦_⟧ₐₛ ∘ ↓ₐₛ) Δ ≡ Δ</a>

<a id="3111" class="Comment">-- id⟦⟧↓ₐₛ : ∀ {Δ} → map ⟦_⟧ₐ (map ↓ₐ Δ) ≡ Δ</a>
<a id="3156" class="Comment">-- id⟦⟧↓ₐₛ {∙}              = refl</a>
<a id="3191" class="Comment">-- id⟦⟧↓ₐₛ {Δ , S4.⟪⊫ A ⟫} = _,_ &amp; id⟦⟧↓ₐₛ ⊗ id⟦⟧↓ₐ</a>


<a id="3245" class="Comment">-- {-# REWRITE id⟦⟧↓ₚ #-}</a>
<a id="3271" class="Comment">-- {-# REWRITE id⟦⟧↓ₚₛ #-}</a>
<a id="3298" class="Comment">-- id⟦⟧↓∋ₚ : ∀ {Γ A} → (i : Γ ∋ A)</a>
<a id="3333" class="Comment">--                   → (⟦_⟧∋ₚ ∘ ↓∋ₚ) i ≡ i</a>
<a id="3376" class="Comment">-- id⟦⟧↓∋ₚ zero    = refl</a>
<a id="3402" class="Comment">-- id⟦⟧↓∋ₚ (suc i) = suc &amp; id⟦⟧↓∋ₚ i</a>


<a id="3441" class="Comment">-- {-# REWRITE id⟦⟧↓ₐₛ #-}</a>
<a id="3468" class="Comment">-- id⟦⟧↓∋ₐ : ∀ {Δ A} → (i : Δ ∋ S4.⟪⊫ A ⟫)</a>
<a id="3511" class="Comment">--                   → (⟦_⟧∋ₐ ∘ ↓∋ₐ) i ≡ i</a>
<a id="3554" class="Comment">-- id⟦⟧↓∋ₐ zero    = refl</a>
<a id="3580" class="Comment">-- id⟦⟧↓∋ₐ (suc i) = suc &amp; id⟦⟧↓∋ₐ i</a>


<a id="3619" class="Comment">-- {-# REWRITE id⟦⟧↓∋ₚ #-}</a>
<a id="3646" class="Comment">-- {-# REWRITE id⟦⟧↓∋ₐ #-}</a>
<a id="3673" class="Comment">-- id⟦⟧↓ : ∀ {Δ Γ A} → (𝒟 : Δ S4.⊢ A valid[ Γ ])</a>
<a id="3722" class="Comment">--                   → (⟦_⟧ ∘ ↓) 𝒟 ≡ 𝒟</a>
<a id="3761" class="Comment">-- id⟦⟧↓ (S4.var i)      = refl</a>
<a id="3793" class="Comment">-- id⟦⟧↓ (S4.lam 𝒟)      = S4.lam &amp; id⟦⟧↓ 𝒟</a>
<a id="3837" class="Comment">-- id⟦⟧↓ (S4.app 𝒟 ℰ)    = S4.app &amp; id⟦⟧↓ 𝒟 ⊗ id⟦⟧↓ ℰ</a>
<a id="3891" class="Comment">-- id⟦⟧↓ (S4.mvar i)     = refl</a>
<a id="3923" class="Comment">-- id⟦⟧↓ (S4.box 𝒟)      = S4.box &amp; id⟦⟧↓ 𝒟</a>
<a id="3967" class="Comment">-- id⟦⟧↓ (S4.letbox 𝒟 ℰ) = S4.letbox &amp; id⟦⟧↓ 𝒟 ⊗ id⟦⟧↓ ℰ</a>


<a id="4026" class="Comment">-- --------------------------------------------------------------------------------</a>
</pre></body></html>