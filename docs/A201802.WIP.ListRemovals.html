<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.ListRemovals</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="A201802.WIP.ListRemovals.html" class="Module">A201802.WIP.ListRemovals</a> <a id="33" class="Keyword">where</a>

<a id="40" class="Keyword">open</a> <a id="45" class="Keyword">import</a> <a id="52" href="A201801.Prelude.html" class="Module">A201801.Prelude</a>
<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="A201801.Category.html" class="Module">A201801.Category</a>
<a id="97" class="Keyword">open</a> <a id="102" class="Keyword">import</a> <a id="109" href="A201801.List.html" class="Module">A201801.List</a>
<a id="122" class="Keyword">open</a> <a id="127" class="Keyword">import</a> <a id="134" href="A201801.ListLemmas.html" class="Module">A201801.ListLemmas</a>


<a id="155" class="Comment">--------------------------------------------------------------------------------</a>


<a id="238" class="Comment">-- McBride&#39;s context removals</a>

<a id="_-_"></a><a id="269" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">_-_</a> <a id="273" class="Symbol">:</a> <a id="275" class="Symbol">∀</a> <a id="277" class="Symbol">{</a><a id="278" href="A201802.WIP.ListRemovals.html#278" class="Bound">X</a> <a id="280" href="A201802.WIP.ListRemovals.html#280" class="Bound">A</a><a id="281" class="Symbol">}</a> <a id="283" class="Symbol">→</a> <a id="285" class="Symbol">(</a><a id="286" href="A201802.WIP.ListRemovals.html#286" class="Bound">Ξ</a> <a id="288" class="Symbol">:</a> <a id="290" href="A201801.List.html#199" class="Datatype">List</a> <a id="295" href="A201802.WIP.ListRemovals.html#278" class="Bound">X</a><a id="296" class="Symbol">)</a> <a id="298" class="Symbol">→</a> <a id="300" href="A201802.WIP.ListRemovals.html#286" class="Bound">Ξ</a> <a id="302" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="304" href="A201802.WIP.ListRemovals.html#280" class="Bound">A</a> <a id="306" class="Symbol">→</a> <a id="308" href="A201801.List.html#199" class="Datatype">List</a> <a id="313" href="A201802.WIP.ListRemovals.html#278" class="Bound">X</a>
<a id="315" href="A201801.List.html#232" class="InductiveConstructor">∙</a>       <a id="323" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">-</a> <a id="325" class="Symbol">()</a>
<a id="328" class="Symbol">(</a><a id="329" href="A201802.WIP.ListRemovals.html#329" class="Bound">Ξ</a> <a id="331" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="333" href="A201802.WIP.ListRemovals.html#333" class="Bound">A</a><a id="334" class="Symbol">)</a> <a id="336" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">-</a> <a id="338" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>  <a id="344" class="Symbol">=</a> <a id="346" href="A201802.WIP.ListRemovals.html#329" class="Bound">Ξ</a>
<a id="348" class="Symbol">(</a><a id="349" href="A201802.WIP.ListRemovals.html#349" class="Bound">Ξ</a> <a id="351" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="353" href="A201802.WIP.ListRemovals.html#353" class="Bound">B</a><a id="354" class="Symbol">)</a> <a id="356" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">-</a> <a id="358" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="362" href="A201802.WIP.ListRemovals.html#362" class="Bound">i</a> <a id="364" class="Symbol">=</a> <a id="366" class="Symbol">(</a><a id="367" href="A201802.WIP.ListRemovals.html#349" class="Bound">Ξ</a> <a id="369" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">-</a> <a id="371" href="A201802.WIP.ListRemovals.html#362" class="Bound">i</a><a id="372" class="Symbol">)</a> <a id="374" href="A201801.List.html#249" class="InductiveConstructor Operator">,</a> <a id="376" href="A201802.WIP.ListRemovals.html#353" class="Bound">B</a>

<a id="del⊇"></a><a id="379" href="A201802.WIP.ListRemovals.html#379" class="Function">del⊇</a> <a id="384" class="Symbol">:</a> <a id="386" class="Symbol">∀</a> <a id="388" class="Symbol">{</a><a id="389" href="A201802.WIP.ListRemovals.html#389" class="Bound">X</a> <a id="391" href="A201802.WIP.ListRemovals.html#391" class="Bound">A</a><a id="392" class="Symbol">}</a> <a id="394" class="Symbol">→</a> <a id="396" class="Symbol">{</a><a id="397" href="A201802.WIP.ListRemovals.html#397" class="Bound">Ξ</a> <a id="399" class="Symbol">:</a> <a id="401" href="A201801.List.html#199" class="Datatype">List</a> <a id="406" href="A201802.WIP.ListRemovals.html#389" class="Bound">X</a><a id="407" class="Symbol">}</a>
               <a id="424" class="Symbol">→</a> <a id="426" class="Symbol">(</a><a id="427" href="A201802.WIP.ListRemovals.html#427" class="Bound">i</a> <a id="429" class="Symbol">:</a> <a id="431" href="A201802.WIP.ListRemovals.html#397" class="Bound">Ξ</a> <a id="433" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="435" href="A201802.WIP.ListRemovals.html#391" class="Bound">A</a><a id="436" class="Symbol">)</a>
               <a id="453" class="Symbol">→</a> <a id="455" href="A201802.WIP.ListRemovals.html#397" class="Bound">Ξ</a> <a id="457" href="A201801.List.html#1387" class="Datatype Operator">⊇</a> <a id="459" href="A201802.WIP.ListRemovals.html#397" class="Bound">Ξ</a> <a id="461" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">-</a> <a id="463" href="A201802.WIP.ListRemovals.html#427" class="Bound">i</a>
<a id="465" href="A201802.WIP.ListRemovals.html#379" class="Function">del⊇</a> <a id="470" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>    <a id="478" class="Symbol">=</a> <a id="480" href="A201801.List.html#1449" class="InductiveConstructor">drop</a> <a id="485" href="A201801.Category.html#263" class="Field">id</a>
<a id="488" href="A201802.WIP.ListRemovals.html#379" class="Function">del⊇</a> <a id="493" class="Symbol">(</a><a id="494" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="498" href="A201802.WIP.ListRemovals.html#498" class="Bound">i</a><a id="499" class="Symbol">)</a> <a id="501" class="Symbol">=</a> <a id="503" href="A201801.List.html#1516" class="InductiveConstructor">keep</a> <a id="508" class="Symbol">(</a><a id="509" href="A201802.WIP.ListRemovals.html#379" class="Function">del⊇</a> <a id="514" href="A201802.WIP.ListRemovals.html#498" class="Bound">i</a><a id="515" class="Symbol">)</a>


<a id="519" class="Comment">-- McBride&#39;s removal-based variable equality</a>

<a id="565" class="Keyword">data</a> <a id="_≡∋_"></a><a id="570" href="A201802.WIP.ListRemovals.html#570" class="Datatype Operator">_≡∋_</a> <a id="575" class="Symbol">{</a><a id="576" href="A201802.WIP.ListRemovals.html#576" class="Bound">X</a><a id="577" class="Symbol">}</a> <a id="579" class="Symbol">:</a> <a id="581" class="Symbol">∀</a> <a id="583" class="Symbol">{</a><a id="584" href="A201802.WIP.ListRemovals.html#584" class="Bound">A</a> <a id="586" href="A201802.WIP.ListRemovals.html#586" class="Bound">B</a><a id="587" class="Symbol">}</a> <a id="589" class="Symbol">→</a> <a id="591" class="Symbol">{</a><a id="592" href="A201802.WIP.ListRemovals.html#592" class="Bound">Ξ</a> <a id="594" class="Symbol">:</a> <a id="596" href="A201801.List.html#199" class="Datatype">List</a> <a id="601" href="A201802.WIP.ListRemovals.html#576" class="Bound">X</a><a id="602" class="Symbol">}</a> <a id="604" class="Symbol">→</a> <a id="606" href="A201802.WIP.ListRemovals.html#592" class="Bound">Ξ</a> <a id="608" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="610" href="A201802.WIP.ListRemovals.html#584" class="Bound">A</a> <a id="612" class="Symbol">→</a> <a id="614" href="A201802.WIP.ListRemovals.html#592" class="Bound">Ξ</a> <a id="616" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="618" href="A201802.WIP.ListRemovals.html#586" class="Bound">B</a> <a id="620" class="Symbol">→</a> <a id="622" class="PrimitiveType">Set</a>
  <a id="628" class="Keyword">where</a>
    <a id="_≡∋_.same"></a><a id="638" href="A201802.WIP.ListRemovals.html#638" class="InductiveConstructor">same</a> <a id="643" class="Symbol">:</a> <a id="645" class="Symbol">∀</a> <a id="647" class="Symbol">{</a><a id="648" href="A201802.WIP.ListRemovals.html#648" class="Bound">A</a><a id="649" class="Symbol">}</a> <a id="651" class="Symbol">→</a> <a id="653" class="Symbol">{</a><a id="654" href="A201802.WIP.ListRemovals.html#654" class="Bound">Ξ</a> <a id="656" class="Symbol">:</a> <a id="658" href="A201801.List.html#199" class="Datatype">List</a> <a id="663" href="A201802.WIP.ListRemovals.html#576" class="Bound">X</a><a id="664" class="Symbol">}</a>
                 <a id="683" class="Symbol">→</a> <a id="685" class="Symbol">(</a><a id="686" href="A201802.WIP.ListRemovals.html#686" class="Bound">i</a> <a id="688" class="Symbol">:</a> <a id="690" href="A201802.WIP.ListRemovals.html#654" class="Bound">Ξ</a> <a id="692" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="694" href="A201802.WIP.ListRemovals.html#648" class="Bound">A</a><a id="695" class="Symbol">)</a>
                 <a id="714" class="Symbol">→</a> <a id="716" href="A201802.WIP.ListRemovals.html#686" class="Bound">i</a> <a id="718" href="A201802.WIP.ListRemovals.html#570" class="Datatype Operator">≡∋</a> <a id="721" href="A201802.WIP.ListRemovals.html#686" class="Bound">i</a>

    <a id="_≡∋_.diff"></a><a id="728" href="A201802.WIP.ListRemovals.html#728" class="InductiveConstructor">diff</a> <a id="733" class="Symbol">:</a> <a id="735" class="Symbol">∀</a> <a id="737" class="Symbol">{</a><a id="738" href="A201802.WIP.ListRemovals.html#738" class="Bound">A</a> <a id="740" href="A201802.WIP.ListRemovals.html#740" class="Bound">B</a><a id="741" class="Symbol">}</a> <a id="743" class="Symbol">→</a> <a id="745" class="Symbol">{</a><a id="746" href="A201802.WIP.ListRemovals.html#746" class="Bound">Ξ</a> <a id="748" class="Symbol">:</a> <a id="750" href="A201801.List.html#199" class="Datatype">List</a> <a id="755" href="A201802.WIP.ListRemovals.html#576" class="Bound">X</a><a id="756" class="Symbol">}</a>
                   <a id="777" class="Symbol">→</a> <a id="779" class="Symbol">(</a><a id="780" href="A201802.WIP.ListRemovals.html#780" class="Bound">i</a> <a id="782" class="Symbol">:</a> <a id="784" href="A201802.WIP.ListRemovals.html#746" class="Bound">Ξ</a> <a id="786" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="788" href="A201802.WIP.ListRemovals.html#738" class="Bound">A</a><a id="789" class="Symbol">)</a> <a id="791" class="Symbol">(</a><a id="792" href="A201802.WIP.ListRemovals.html#792" class="Bound">j</a> <a id="794" class="Symbol">:</a> <a id="796" href="A201802.WIP.ListRemovals.html#746" class="Bound">Ξ</a> <a id="798" href="A201802.WIP.ListRemovals.html#269" class="Function Operator">-</a> <a id="800" href="A201802.WIP.ListRemovals.html#780" class="Bound">i</a> <a id="802" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="804" href="A201802.WIP.ListRemovals.html#740" class="Bound">B</a><a id="805" class="Symbol">)</a>
                   <a id="826" class="Symbol">→</a> <a id="828" href="A201802.WIP.ListRemovals.html#780" class="Bound">i</a> <a id="830" href="A201802.WIP.ListRemovals.html#570" class="Datatype Operator">≡∋</a> <a id="833" href="A201801.List.html#2469" class="Function">ren∋</a> <a id="838" class="Symbol">(</a><a id="839" href="A201802.WIP.ListRemovals.html#379" class="Function">del⊇</a> <a id="844" href="A201802.WIP.ListRemovals.html#780" class="Bound">i</a><a id="845" class="Symbol">)</a> <a id="847" href="A201802.WIP.ListRemovals.html#792" class="Bound">j</a>

<a id="_≟∋_"></a><a id="850" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">_≟∋_</a> <a id="855" class="Symbol">:</a> <a id="857" class="Symbol">∀</a> <a id="859" class="Symbol">{</a><a id="860" href="A201802.WIP.ListRemovals.html#860" class="Bound">X</a> <a id="862" href="A201802.WIP.ListRemovals.html#862" class="Bound">A</a> <a id="864" href="A201802.WIP.ListRemovals.html#864" class="Bound">B</a><a id="865" class="Symbol">}</a> <a id="867" class="Symbol">→</a> <a id="869" class="Symbol">{</a><a id="870" href="A201802.WIP.ListRemovals.html#870" class="Bound">Ξ</a> <a id="872" class="Symbol">:</a> <a id="874" href="A201801.List.html#199" class="Datatype">List</a> <a id="879" href="A201802.WIP.ListRemovals.html#860" class="Bound">X</a><a id="880" class="Symbol">}</a>
                 <a id="899" class="Symbol">→</a> <a id="901" class="Symbol">(</a><a id="902" href="A201802.WIP.ListRemovals.html#902" class="Bound">i</a> <a id="904" class="Symbol">:</a> <a id="906" href="A201802.WIP.ListRemovals.html#870" class="Bound">Ξ</a> <a id="908" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="910" href="A201802.WIP.ListRemovals.html#862" class="Bound">A</a><a id="911" class="Symbol">)</a> <a id="913" class="Symbol">(</a><a id="914" href="A201802.WIP.ListRemovals.html#914" class="Bound">j</a> <a id="916" class="Symbol">:</a> <a id="918" href="A201802.WIP.ListRemovals.html#870" class="Bound">Ξ</a> <a id="920" href="A201801.List.html#2340" class="Datatype Operator">∋</a> <a id="922" href="A201802.WIP.ListRemovals.html#864" class="Bound">B</a><a id="923" class="Symbol">)</a>
                 <a id="942" class="Symbol">→</a> <a id="944" href="A201802.WIP.ListRemovals.html#902" class="Bound">i</a> <a id="946" href="A201802.WIP.ListRemovals.html#570" class="Datatype Operator">≡∋</a> <a id="949" href="A201802.WIP.ListRemovals.html#914" class="Bound">j</a>
<a id="951" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>  <a id="957" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="960" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>   <a id="967" class="Symbol">=</a> <a id="969" href="A201802.WIP.ListRemovals.html#638" class="InductiveConstructor">same</a> <a id="974" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>
<a id="979" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>  <a id="985" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="988" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="992" href="A201802.WIP.ListRemovals.html#992" class="Bound">j</a>  <a id="995" class="Keyword">rewrite</a> <a id="1003" href="A201801.ListLemmas.html#4384" class="Function">id-ren∋</a> <a id="1011" href="A201802.WIP.ListRemovals.html#992" class="Bound">j</a> <a id="1013" href="A201801.Prelude.html#1666" class="Field Operator">⁻¹</a> <a id="1016" class="Symbol">=</a> <a id="1018" href="A201802.WIP.ListRemovals.html#728" class="InductiveConstructor">diff</a> <a id="1023" href="A201801.List.html#2379" class="InductiveConstructor">zero</a> <a id="1028" href="A201802.WIP.ListRemovals.html#992" class="Bound">j</a>
<a id="1030" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1034" href="A201802.WIP.ListRemovals.html#1034" class="Bound">i</a> <a id="1036" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="1039" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>   <a id="1046" class="Symbol">=</a> <a id="1048" href="A201802.WIP.ListRemovals.html#728" class="InductiveConstructor">diff</a> <a id="1053" class="Symbol">(</a><a id="1054" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1058" href="A201802.WIP.ListRemovals.html#1034" class="Bound">i</a><a id="1059" class="Symbol">)</a> <a id="1061" href="A201801.List.html#2379" class="InductiveConstructor">zero</a>
<a id="1066" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1070" href="A201802.WIP.ListRemovals.html#1070" class="Bound">i</a> <a id="1072" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="1075" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1079" href="A201802.WIP.ListRemovals.html#1079" class="Bound">j</a>  <a id="1082" class="Keyword">with</a> <a id="1087" href="A201802.WIP.ListRemovals.html#1070" class="Bound">i</a> <a id="1089" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="1092" href="A201802.WIP.ListRemovals.html#1079" class="Bound">j</a>
<a id="1094" class="InductiveConstructor">suc</a> <a id="1098" href="A201802.WIP.ListRemovals.html#1098" class="Bound">i</a> <a id="1100" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="1103" class="InductiveConstructor">suc</a> <a id="1107" class="DottedPattern Symbol">.</a><a id="1108" href="A201802.WIP.ListRemovals.html#1098" class="DottedPattern Bound">i</a> <a id="1110" class="Symbol">|</a> <a id="1112" href="A201802.WIP.ListRemovals.html#638" class="InductiveConstructor">same</a> <a id="1117" class="DottedPattern Symbol">.</a><a id="1118" href="A201802.WIP.ListRemovals.html#1098" class="DottedPattern Bound">i</a> <a id="1120" class="Symbol">=</a> <a id="1122" href="A201802.WIP.ListRemovals.html#638" class="InductiveConstructor">same</a> <a id="1127" class="Symbol">(</a><a id="1128" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1132" href="A201802.WIP.ListRemovals.html#1098" class="Bound">i</a><a id="1133" class="Symbol">)</a>
<a id="1135" class="InductiveConstructor">suc</a> <a id="1139" href="A201802.WIP.ListRemovals.html#1139" class="Bound">i</a> <a id="1141" href="A201802.WIP.ListRemovals.html#850" class="Function Operator">≟∋</a> <a id="1144" class="InductiveConstructor">suc</a> <a id="1148" class="DottedPattern Symbol">._</a> <a id="1151" class="Symbol">|</a> <a id="1153" href="A201802.WIP.ListRemovals.html#728" class="InductiveConstructor">diff</a> <a id="1158" class="DottedPattern Symbol">.</a><a id="1159" href="A201802.WIP.ListRemovals.html#1139" class="DottedPattern Bound">i</a> <a id="1161" href="A201802.WIP.ListRemovals.html#1161" class="Bound">j</a> <a id="1163" class="Symbol">=</a> <a id="1165" href="A201802.WIP.ListRemovals.html#728" class="InductiveConstructor">diff</a> <a id="1170" class="Symbol">(</a><a id="1171" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1175" href="A201802.WIP.ListRemovals.html#1139" class="Bound">i</a><a id="1176" class="Symbol">)</a> <a id="1178" class="Symbol">(</a><a id="1179" href="A201801.List.html#2411" class="InductiveConstructor">suc</a> <a id="1183" href="A201802.WIP.ListRemovals.html#1161" class="Bound">j</a><a id="1184" class="Symbol">)</a>


<a id="1188" class="Comment">--------------------------------------------------------------------------------</a>
</pre></body></html>