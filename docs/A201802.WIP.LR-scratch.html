<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>A201802.WIP.LR-scratch</title><link rel="stylesheet" href="mi-common.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="A201802.WIP.LR-scratch.html" class="Module">A201802.WIP.LR-scratch</a> <a id="31" class="Keyword">where</a>

<a id="38" class="Comment">--------------------------------------------------------------------------------</a>


<a id="121" class="Comment">{-
-- Value non-reduction.
vnr : ‚àÄ {g} ‚Üí {M : Val g} {M‚Ä≤ : Term g}
            ‚Üí ¬¨ (Val.term M ‚Ü¶ M‚Ä≤)
vnr {M = val (LAM M) {{iv-LAM}}}   M‚Ü¶M‚Ä≤ = {!!}
vnr {M = val TRUE    {{iv-TRUE}}}  M‚Ü¶M‚Ä≤ = {!!}
vnr {M = val FALSE   {{iv-FALSE}}} M‚Ü¶M‚Ä≤ = {!!}


-- Determinism.
uniq‚Ü¶ : ‚àÄ {g} ‚Üí {M M‚Ä≤‚ÇÅ M‚Ä≤‚ÇÇ : Term g}
               ‚Üí M ‚Ü¶ M‚Ä≤‚ÇÅ ‚Üí M ‚Ü¶ M‚Ä≤‚ÇÇ
               ‚Üí M‚Ä≤‚ÇÅ ‚â° M‚Ä≤‚ÇÇ
uniq‚Ü¶ red-APP-LAM         M‚Ü¶M‚Ä≤‚ÇÇ = {!!}
uniq‚Ü¶ red-IF-TRUE         M‚Ü¶M‚Ä≤‚ÇÇ = {!!}
uniq‚Ü¶ red-IF-FALSE        M‚Ü¶M‚Ä≤‚ÇÇ = {!!}
uniq‚Ü¶ (red-cong E M‚Ü¶M‚Ä≤‚ÇÅ) M‚Ü¶M‚Ä≤‚ÇÇ = {!!}

uniq‚§Ö : ‚àÄ {g} ‚Üí {M M‚Ä≤‚ÇÅ M‚Ä≤‚ÇÇ : Term g}
               ‚Üí M ‚§Ö M‚Ä≤‚ÇÅ ‚Üí M ‚§Ö M‚Ä≤‚ÇÇ
               ‚Üí M‚Ä≤‚ÇÅ ‚â° M‚Ä≤‚ÇÇ
uniq‚§Ö done                   done                   = refl
uniq‚§Ö done                   (step M‚Ü¶M‚Ä≥‚ÇÇ M‚Ä≥‚ÇÇ‚§ÖM‚Ä≤‚ÇÇ) = {!!}
uniq‚§Ö (step M‚Ü¶M‚Ä≥‚ÇÅ M‚Ä≥‚ÇÅ‚§ÖM‚Ä≤‚ÇÅ) done                   = {!!}
uniq‚§Ö (step M‚Ü¶M‚Ä≥‚ÇÅ M‚Ä≥‚ÇÅ‚§ÖM‚Ä≤‚ÇÅ) (step M‚Ü¶M‚Ä≥‚ÇÇ M‚Ä≥‚ÇÇ‚§ÖM‚Ä≤‚ÇÇ) = {!!}
-}</a>



<a id="969" class="Comment">-- foo : ‚àÄ {g} ‚Üí {M M‚Ä≤ : Term g}</a>
<a id="1002" class="Comment">--             ‚Üí M ‚§Ö M‚Ä≤</a>
<a id="1026" class="Comment">--             ‚Üí M ‚â° M‚Ä≤ ‚äé Œ£ (Term g) (\ M‚Ä≥ ‚Üí M ‚Ü¶ M‚Ä≥ √ó M‚Ä≥ ‚§Ö M‚Ä≤)</a>
<a id="1089" class="Comment">-- foo done                = inj‚ÇÅ refl</a>
<a id="1128" class="Comment">-- foo (step M‚Ü¶M‚Ä≥ M‚Ä≥‚§ÖM‚Ä≤) = inj‚ÇÇ (_ , (M‚Ü¶M‚Ä≥ , M‚Ä≥‚§ÖM‚Ä≤))</a>


<a id="1183" class="Comment">-- inj-VAR : ‚àÄ {g} ‚Üí {I‚ÇÅ I‚ÇÇ : Fin g}</a>
<a id="1220" class="Comment">--                 ‚Üí VAR I‚ÇÅ ‚â° VAR I‚ÇÇ</a>
<a id="1257" class="Comment">--                 ‚Üí I‚ÇÅ ‚â° I‚ÇÇ</a>
<a id="1286" class="Comment">-- inj-VAR refl = refl</a>

<a id="1310" class="Comment">-- inj-LAM : ‚àÄ {g} ‚Üí {M‚ÇÅ M‚ÇÇ : Term (suc g)}</a>
<a id="1354" class="Comment">--                 ‚Üí LAM M‚ÇÅ ‚â° LAM M‚ÇÇ</a>
<a id="1391" class="Comment">--                 ‚Üí M‚ÇÅ ‚â° M‚ÇÇ</a>
<a id="1420" class="Comment">-- inj-LAM refl = refl</a>

<a id="1444" class="Comment">-- inj-APP‚ÇÅ : ‚àÄ {g} ‚Üí {M‚ÇÅ M‚ÇÇ N : Term g}</a>
<a id="1485" class="Comment">--                  ‚Üí APP M‚ÇÅ N ‚â° APP M‚ÇÇ N</a>
<a id="1527" class="Comment">--                  ‚Üí M‚ÇÅ ‚â° M‚ÇÇ</a>
<a id="1557" class="Comment">-- inj-APP‚ÇÅ refl = refl</a>

<a id="1582" class="Comment">-- inj-APP‚ÇÇ : ‚àÄ {g} ‚Üí {M N‚ÇÅ N‚ÇÇ : Term g}</a>
<a id="1623" class="Comment">--                  ‚Üí APP M N‚ÇÅ ‚â° APP M N‚ÇÇ</a>
<a id="1665" class="Comment">--                  ‚Üí N‚ÇÅ ‚â° N‚ÇÇ</a>
<a id="1695" class="Comment">-- inj-APP‚ÇÇ refl = refl</a>

<a id="1720" class="Comment">-- inj-IF‚ÇÅ : ‚àÄ {g} ‚Üí {M‚ÇÅ M‚ÇÇ N O : Term g}</a>
<a id="1762" class="Comment">--                 ‚Üí IF M‚ÇÅ N O ‚â° IF M‚ÇÇ N O</a>
<a id="1805" class="Comment">--                 ‚Üí M‚ÇÅ ‚â° M‚ÇÇ</a>
<a id="1834" class="Comment">-- inj-IF‚ÇÅ refl = refl</a>

<a id="1858" class="Comment">-- inj-IF‚ÇÇ : ‚àÄ {g} ‚Üí {M N‚ÇÅ N‚ÇÇ O : Term g}</a>
<a id="1900" class="Comment">--                 ‚Üí IF M N‚ÇÅ O ‚â° IF M N‚ÇÇ O</a>
<a id="1943" class="Comment">--                 ‚Üí N‚ÇÅ ‚â° N‚ÇÇ</a>
<a id="1972" class="Comment">-- inj-IF‚ÇÇ refl = refl</a>

<a id="1996" class="Comment">-- inj-IF‚ÇÉ : ‚àÄ {g} ‚Üí {M N O‚ÇÅ O‚ÇÇ : Term g}</a>
<a id="2038" class="Comment">--                 ‚Üí IF M N O‚ÇÅ ‚â° IF M N O‚ÇÇ</a>
<a id="2081" class="Comment">--                 ‚Üí O‚ÇÅ ‚â° O‚ÇÇ</a>
<a id="2110" class="Comment">-- inj-IF‚ÇÉ refl = refl</a>


<a id="2135" class="Comment">-- inj[]‚ÇÅ : ‚àÄ {g} ‚Üí {E‚ÇÅ E‚ÇÇ : EvCx g} {M : Term g}</a>
<a id="2185" class="Comment">--                ‚Üí E‚ÇÅ [ M ] ‚â° E‚ÇÇ [ M ]</a>
<a id="2225" class="Comment">--                ‚Üí E‚ÇÅ ‚â° E‚ÇÇ</a>
<a id="2253" class="Comment">-- inj[]‚ÇÅ {E‚ÇÅ = E‚ÇÅ} {E‚ÇÇ} p = {!!}</a>

<a id="2288" class="Comment">-- inj[]‚ÇÇ : ‚àÄ {g} ‚Üí {M‚ÇÅ M‚ÇÇ : Term g}</a>
<a id="2325" class="Comment">--                ‚Üí (E : EvCx g) ‚Üí E [ M‚ÇÅ ] ‚â° E [ M‚ÇÇ ]</a>
<a id="2380" class="Comment">--                ‚Üí M‚ÇÅ ‚â° M‚ÇÇ</a>
<a id="2408" class="Comment">-- inj[]‚ÇÇ ec-[]            refl = refl</a>
<a id="2447" class="Comment">-- inj[]‚ÇÇ (ec-fun-APP E N) p    = inj[]‚ÇÇ E (inj-APP‚ÇÅ p)</a>
<a id="2503" class="Comment">-- inj[]‚ÇÇ (ec-APP-arg M E) p    = inj[]‚ÇÇ E (inj-APP‚ÇÇ p)</a>
<a id="2559" class="Comment">-- inj[]‚ÇÇ (ec-IF E N O)    p    = inj[]‚ÇÇ E (inj-IF‚ÇÅ p)</a>


<a id="2616" class="Comment">-- uniq[] : ‚àÄ {g} ‚Üí {M M‚Ä≤‚ÇÅ M‚Ä≤‚ÇÇ : Term g}</a>
<a id="2657" class="Comment">--                ‚Üí (E : EvCx g) ‚Üí E [ M ] ‚â° M‚Ä≤‚ÇÅ ‚Üí E [ M ] ‚â° M‚Ä≤‚ÇÇ</a>
<a id="2722" class="Comment">--                ‚Üí M‚Ä≤‚ÇÅ ‚â° M‚Ä≤‚ÇÇ</a>
<a id="2752" class="Comment">-- uniq[] E refl refl = refl</a>


<a id="2783" class="Comment">-- uniq‚Ü¶ : ‚àÄ {g} ‚Üí {M M‚Ä≤‚ÇÅ M‚Ä≤‚ÇÇ : Term g}</a>
<a id="2823" class="Comment">--                ‚Üí M ‚Ü¶ M‚Ä≤‚ÇÅ ‚Üí M ‚Ü¶ M‚Ä≤‚ÇÇ</a>
<a id="2861" class="Comment">--                ‚Üí M‚Ä≤‚ÇÅ ‚â° M‚Ä≤‚ÇÇ</a>
<a id="2891" class="Comment">-- uniq‚Ü¶ (red-APP-LAM {{refl}})               (red-APP-LAM {{refl}})               = refl</a>
<a id="2981" class="Comment">-- uniq‚Ü¶ red-IF-TRUE                          red-IF-TRUE                          = refl</a>
<a id="3071" class="Comment">-- uniq‚Ü¶ red-IF-FALSE                         red-IF-FALSE                         = refl</a>
<a id="3161" class="Comment">-- uniq‚Ü¶ (red-cong E‚ÇÅ M‚Ü¶M‚Ä≤‚ÇÅ {{p‚ÇÅ}} {{refl}}) (red-APP-LAM {{refl}})               = {!!}</a>
<a id="3250" class="Comment">-- uniq‚Ü¶ (red-cong E‚ÇÅ M‚Ü¶M‚Ä≤‚ÇÅ {{p‚ÇÅ}} {{refl}}) red-IF-TRUE                          = {!!}</a>
<a id="3339" class="Comment">-- uniq‚Ü¶ (red-cong E‚ÇÅ M‚Ü¶M‚Ä≤‚ÇÅ {{p‚ÇÅ}} {{refl}}) red-IF-FALSE                         = {!!}</a>
<a id="3428" class="Comment">-- uniq‚Ü¶ (red-APP-LAM {{refl}})               (red-cong E‚ÇÇ M‚Ü¶M‚Ä≤‚ÇÇ {{p‚ÇÇ}} {{refl}}) = {!!}</a>
<a id="3517" class="Comment">-- uniq‚Ü¶ red-IF-TRUE                          (red-cong E‚ÇÇ M‚Ü¶M‚Ä≤‚ÇÇ {{p‚ÇÇ}} {{refl}}) = {!!}</a>
<a id="3606" class="Comment">-- uniq‚Ü¶ red-IF-FALSE                         (red-cong E‚ÇÇ M‚Ü¶M‚Ä≤‚ÇÇ {{p‚ÇÇ}} {{refl}}) = {!!}</a>
<a id="3695" class="Comment">-- uniq‚Ü¶ (red-cong E‚ÇÅ M‚Ü¶M‚Ä≤‚ÇÅ {{p‚ÇÅ}} {{refl}}) (red-cong E‚ÇÇ M‚Ü¶M‚Ä≤‚ÇÇ {{p‚ÇÇ}} {{refl}}) = {!uniq‚Ü¶ M‚Ü¶M‚Ä≤‚ÇÅ M‚Ü¶M‚Ä≤‚ÇÇ!}</a>


<a id="3802" class="Comment">-- bar : ‚àÄ {g} ‚Üí {M M‚Ä≤ M‚Ä≥ : Term g}</a>
<a id="3838" class="Comment">--             ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí M ‚§Ö M‚Ä≥ ‚Üí {{_ : ¬¨ (M ‚â° M‚Ä≥)}}</a>
<a id="3892" class="Comment">--             ‚Üí M‚Ä≤ ‚§Ö M‚Ä≥</a>
<a id="3917" class="Comment">-- bar M‚Ü¶M‚Ä≤ done                {{p}} = refl ‚ÜØ p</a>
<a id="3966" class="Comment">-- bar M‚Ü¶M‚Ä≤ (step M‚Ü¶M¬∞ M¬∞‚§ÖM‚Ä≥) = {!!}</a>


<a id="4005" class="Comment">-- oops : ‚àÄ {g} ‚Üí {M M‚Ä≤ M‚Ä≥ : Term g}</a>
<a id="4042" class="Comment">--              ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí M ‚§Ö M‚Ä≥</a>
<a id="4076" class="Comment">--              ‚Üí M‚Ä≤ ‚§Ö M‚Ä≥</a>
<a id="4102" class="Comment">-- oops M‚Ü¶M‚Ä≤ done                = {!!}</a>
<a id="4142" class="Comment">-- oops M‚Ü¶M‚Ä≤ (step M‚Ü¶M¬∞ M¬∞‚§ÖM‚Ä≥) = {!!}</a>


<a id="4182" class="Comment">-- --------------------------------------------------------------------------------</a>


<a id="4268" class="Comment">-- red-cong-APP-LAM : ‚àÄ {g} ‚Üí {M N N‚Ä≤ : Term g} {M‚Ä≤ : Term (suc g)}</a>
<a id="4336" class="Comment">--                          ‚Üí M ‚§Ö LAM M‚Ä≤ ‚Üí N ‚§Ö N‚Ä≤</a>
<a id="4386" class="Comment">--                          ‚Üí APP (LAM M‚Ä≤) N ‚§Ö CUT N‚Ä≤ M‚Ä≤</a>
<a id="4443" class="Comment">-- red-cong-APP-LAM M‚§ÖLAM-M‚Ä≤ N‚§ÖN‚Ä≤ = {!!}</a>


<a id="4486" class="Comment">-- halt-APP : ‚àÄ {g} ‚Üí {M N : Term g} {M‚Ä≤ : Term (suc g)}</a>
<a id="4543" class="Comment">--                  ‚Üí M ‚§Ö LAM M‚Ä≤ ‚Üí M‚Ä≤ ‚áì ‚Üí N ‚áì</a>
<a id="4589" class="Comment">--                  ‚Üí APP M N ‚áì</a>
<a id="4621" class="Comment">-- halt-APP M‚§ÖLAM-M‚Ä≤ M‚Ä≤‚áì N‚áì = {!!}</a>




<a id="4660" class="Comment">-- -- SNs : ‚àÄ {g} ‚Üí Vals 0 g ‚Üí Types g ‚Üí Set</a>
<a id="4705" class="Comment">-- -- SNs (vals ‚àô)                       ‚àô       = ‚ä§</a>
<a id="4758" class="Comment">-- -- SNs (vals (œÑ , M) {{av-œÑ , iv-M}}) (Œì , A) = SNs (vals œÑ {{av-œÑ}}) Œì √ó SN M A</a>


<a id="4844" class="Comment">-- -- derps : ‚àÄ {g} ‚Üí {œÑ : Vals 0 g} {Œì : Types g}</a>
<a id="4895" class="Comment">-- --               ‚Üí SNs œÑ Œì</a>
<a id="4925" class="Comment">-- --               ‚Üí ‚àô ‚ä¢ Vals.terms œÑ ‚¶Ç Œì all</a>
<a id="4972" class="Comment">-- -- derps {œÑ = vals ‚àô}                       {‚àô}     ‚àô       = ‚àô</a>
<a id="5039" class="Comment">-- -- derps {œÑ = vals (œÑ , M) {{av-œÑ , iv-M}}} {Œì , A} (œÉ , s) = derps œÉ , derp s</a>


<a id="5123" class="Comment">-- -- tp-SUB : ‚àÄ {g M A} ‚Üí {œÑ : Vals 0 g} {Œì : Types g}</a>
<a id="5179" class="Comment">-- --                    ‚Üí SNs œÑ Œì ‚Üí Œì ‚ä¢ M ‚¶Ç A</a>
<a id="5226" class="Comment">-- --                    ‚Üí ‚àô ‚ä¢ SUB (Vals.terms œÑ) M ‚¶Ç A</a>
<a id="5282" class="Comment">-- -- tp-SUB œÉ ùíü = sub (derps œÉ) ùíü</a>


<a id="5319" class="Comment">-- -- sn-lem‚ÇÅ : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M‚Ä≤ A</a>
<a id="5377" class="Comment">-- --                      ‚Üí SN M A</a>
<a id="5413" class="Comment">-- -- sn-lem‚ÇÅ {ùîπ}     M‚Ü¶M‚Ä≤ ùíü (ùíü‚Ä≤ , (M‚Ä≥ , M‚Ä≤‚§ÖM‚Ä≥))     = ùíü , (M‚Ä≥ , step M‚Ü¶M‚Ä≤ M‚Ä≤‚§ÖM‚Ä≥)</a>
<a id="5495" class="Comment">-- -- sn-lem‚ÇÅ {A ‚äÉ B} M‚Ü¶M‚Ä≤ ùíü (ùíü‚Ä≤ , (M‚Ä≥ , M‚Ä≤‚§ÖM‚Ä≥) , f) =</a>
<a id="5550" class="Comment">-- --   ùíü , (M‚Ä≥ , step M‚Ü¶M‚Ä≤ M‚Ä≤‚§ÖM‚Ä≥) , (\ s ‚Üí sn-lem‚ÇÅ (red-cong (ec-fun-APP ec-[] _) M‚Ü¶M‚Ä≤)</a>
<a id="5639" class="Comment">-- --                                                  (app ùíü (derp s)) (f s))</a>


<a id="5720" class="Comment">-- -- sn-lem‚ÇÇ : ‚àÄ {A M M‚Ä≤} ‚Üí M ‚Ü¶ M‚Ä≤ ‚Üí ‚àô ‚ä¢ M ‚¶Ç A ‚Üí SN M A</a>
<a id="5777" class="Comment">-- --                      ‚Üí SN M‚Ä≤ A</a>
<a id="5814" class="Comment">-- -- sn-lem‚ÇÇ {ùîπ}     M‚Ü¶M‚Ä≤ ùíü (_ , (M‚Ä≥ , M‚§ÖM‚Ä≥))     = {!!}</a>
<a id="5872" class="Comment">-- -- sn-lem‚ÇÇ {A ‚äÉ B} M‚Ü¶M‚Ä≤ ùíü (_ , (M‚Ä≥ , M‚§ÖM‚Ä≥) , f) = {!!}</a>


<a id="5932" class="Comment">-- -- sn-SUB : ‚àÄ {g M A} ‚Üí {œÑ : Vals 0 g} {Œì : Types g}</a>
<a id="5988" class="Comment">-- --                    ‚Üí SNs œÑ Œì ‚Üí Œì ‚ä¢ M ‚¶Ç A</a>
<a id="6035" class="Comment">-- --                    ‚Üí SN (SUB (Vals.terms œÑ) M) A</a>
<a id="6090" class="Comment">-- -- sn-SUB œÉ (var i)    = {!!}</a>
<a id="6123" class="Comment">-- -- sn-SUB œÉ (lam ùíü)    = {!!}</a>
<a id="6156" class="Comment">-- -- sn-SUB œÉ (app ùíü ‚Ñ∞)  = {!!}</a>
<a id="6189" class="Comment">-- -- sn-SUB œÉ true       = true , (val TRUE , done)</a>
<a id="6242" class="Comment">-- -- sn-SUB œÉ false      = false , (val FALSE , done)</a>
<a id="6297" class="Comment">-- -- sn-SUB œÉ (if ùíü ‚Ñ∞ ‚Ñ±) = {!!}</a>


<a id="6332" class="Comment">-- -- --------------------------------------------------------------------------------</a>
</pre></body></html>